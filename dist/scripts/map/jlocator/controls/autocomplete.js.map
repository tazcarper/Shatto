{"version":3,"sources":["map/jlocator/controls/autocomplete.js"],"names":[],"mappings":"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","file":"map/jlocator/controls/autocomplete.js","sourcesContent":["(function($) {\n\t'use strict';\n\n\t/** \n\t * autocomplete control\n\t * @type {Object} \n\t * @name Autocomplete\n\t * @class autocomplete Control\n\t * @memberOf jQuery.fn.jplist.controls\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete = {};\n\n\t/**\n\t * render control html\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.render = function(control) {\n\n\t\tvar autocomplete, zoom, options = {};\n\n\t\tif (control.controlTypeOptions) {\n\t\t\toptions = control.controlTypeOptions;\n\t\t}\n\n\t\t//init autocomplete\n\t\tautocomplete = new google.maps.places.Autocomplete(control.$control.get(0), options);\n\n\t\t//init zoom\n\t\tzoom = Number(control.$control.attr('data-zoom'));\n\n\t\tif (isNaN(zoom)) {\n\t\t\tzoom = 17;\n\t\t}\n\n\t\t//add data\n\t\tcontrol.$control.data('jplist-autocomplete', autocomplete);\n\t\tcontrol.$control.data('jplist-autocomplete-zoom', zoom);\n\t};\n\n\t/**\n\t * init events\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.initEvents = function(control) {\n\n\t\t\n\n\t\t// Handle Enter on search location \n\t\t$('.findInput input').focusin(function() {\n\n\t\t\t$(document).keypress(function(e) {\n\t\t\t\tif (e.which == 13) {\n\t\t\t\t\tconsole.log('enter');\n\t\t\t\t\tif ($('.pac-container .pac-item-selected')[0]) {\n\t\t\t\t\t\tselectFirstResult($('.pac-item-selected'));\n\t\t\t\t\t\tconsole.log('item selected after row')\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectFirstResult($('.pac-container .pac-item:first'));\n\t\t\t\t\t\tconsole.log('first item enter')\n\t\t\t\t\t}\n\t\t\t\t\t$('.mapOverlay').addClass('shrink');\n\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// $('.searchIt').on('click', function(e){\n\t\t// \tselectFirstResult($('.pac-container .pac-item:first'));\n\t\t// });\n\t\tfunction selectFirstResult(result) {\n\t\t\t$(\".pac-container\").hide();\n\t\t\tvar firstResult = result.text();\n\n\t\t\tvar geocoder = new google.maps.Geocoder();\n\n\n\t\t\tgeocoder.geocode({\n\t\t\t\t\"address\": firstResult\n\t\t\t}, function(results, status) {\n\t\t\t\tif (status == google.maps.GeocoderStatus.OK) {\n\t\t\t\t\tconsole.log(results);\n\t\t\t\t\tvar lat = results[0].geometry.location.lat(),\n\t\t\t\t\t\tlng = results[0].geometry.location.lng(),\n\t\t\t\t\t\tplaceName = results[0].address_components[0].long_name,\n\t\t\t\t\t\tformattedAddress = results[0].formatted_address;\n\t\t\t\t\t$(\".findInput input\").val(formattedAddress);\n\t\t\t\t\tcontrol.$control.attr('data-latitude', lat);\n\t\t\t\t\tcontrol.$control.attr('data-longitude', lng);\n\t\t\t\t\tcontrol.$control.attr('data-name', placeName);\n\t\t\t\t\tcontrol.$jplistBox.trigger('jumpEvent', [lat, lng, control.$control.data('jplist-autocomplete-zoom')]);\n\t\t\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar autocomplete, listenerHandle = control.$control.data('jplist-handle');\n\n\t\t//get autocomplete\n\t\tautocomplete = control.$control.data('jplist-autocomplete');\n\n\t\t//remove listener\n\t\tif (listenerHandle) {\n\t\t\tgoogle.maps.event.removeListener(listenerHandle);\n\t\t}\n\n\t\t//add listener\n\t\tlistenerHandle = google.maps.event.addListener(autocomplete, 'place_changed', function() {\n\n\t\t\tvar place, lat, lng;\n\n\t\t\t//get choosen place\n\t\t\tplace = autocomplete.getPlace();\n\n\t\t\t//set latitude and longitude\n\t\t\tif (place.geometry) {\n\n\t\t\t\tlat = place.geometry.location['lat']();\n\t\t\t\tlng = place.geometry.location['lng']();\n\n\t\t\t\tcontrol.$control.attr('data-latitude', lat);\n\t\t\t\tcontrol.$control.attr('data-longitude', lng);\n\t\t\t\tcontrol.$control.attr('data-name', place.name);\n\t\t\t\tconsole.log(place.name);\n\t\t\t\t$('.mapOverlay').addClass('shrink');\n\n\t\t\t\t//trigger jump to map event\n\t\t\t\tcontrol.$jplistBox.trigger('jumpEvent', [lat, lng, control.$control.data('jplist-autocomplete-zoom')]);\n\t\t\t}\n\n\t\t\t//send panel redraw event\n\t\t\tconsole.log('redraw');\n\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\n\t\t});\n\n\t\tcontrol.$control.off('keyup').on('keyup', function(e) {\n\n\t\t\tvar val;\n\n\t\t\t//get val\n\t\t\tval = $.trim($(this).val());\n\n\t\t\tif (val === '') {\n\t\t\t\tconsole.log('blank');\n\t\t\t\tcontrol.$control.attr('data-latitude', '');\n\t\t\t\tcontrol.$control.attr('data-longitude', '');\n\n\t\t\t\t//send panel redraw event\n\t\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\t\t\t}\n\t\t});\n\n\t\t//save handler\n\t\tcontrol.$control.data('jplist-handle', listenerHandle);\n\t};\n\n\t/**\n\t * Set control status\n\t * @param {jQuery.fn.jplist.models.Status} status\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @param {boolean} isCookie - is status restored from cookies\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.setStatus = function(status, control, isCookie) {\n\n\t\t//console.log(status.data);\n\t};\n\n\t/**\n\t * get current control status\n\t * @param {boolean} isDefault - if true, get default (initial) control status; else - get current control status\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @return {jQuery.fn.jplist.models.Status}\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.getStatus = function(isDefault, control) {\n\n\t\tvar status = null,\n\t\t\tlatitude, longitude, data;\n\n\t\t//get attributes\n\t\tlatitude = control.$control.attr('data-latitude');\n\t\tlongitude = control.$control.attr('data-longitude');\n\n\t\tdata = {\n\t\t\tname: control.$control.attr('data-name'),\n\t\t\tradius: control.$control.attr('data-radius'),\n\t\t\tfilterType: 'autocomplete'\n\t\t};\n\n\t\tif (isDefault) {\n\n\t\t\tdata.latitude = '';\n\t\t\tdata.longitude = '';\n\n\t\t\tstatus = new jQuery.fn.jplist.models.Status(control.name, control.action, control.type, data, true);\n\t\t} else {\n\t\t\tif ($.isNumeric(latitude) && $.isNumeric(longitude)) {\n\n\t\t\t\tdata.latitude = latitude;\n\t\t\t\tdata.longitude = longitude;\n\t\t\t\tstatus = new jQuery.fn.jplist.models.Status(control.name, control.action, control.type, data, true);\n\t\t\t}\n\t\t}\n\n\t\treturn status;\n\t};\n\n\n\n\n})(jQuery);"],"sourceRoot":"/source/"}