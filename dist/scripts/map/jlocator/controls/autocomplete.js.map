{"version":3,"sources":["map/jlocator/controls/autocomplete.js"],"names":[],"mappings":"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","file":"map/jlocator/controls/autocomplete.js","sourcesContent":["(function($) {\n\t'use strict';\n\n\t/** \n\t * autocomplete control\n\t * @type {Object} \n\t * @name Autocomplete\n\t * @class autocomplete Control\n\t * @memberOf jQuery.fn.jplist.controls\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete = {};\n\n\t/**\n\t * render control html\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.render = function(control) {\n\n\t\t$('.geoCode').on('click', function(e) { \n\t\t\tvar button = $(this);\n\t\t\tconsole.log('geo clicked');\n\t\t\tif (Modernizr.geolocation) {\n\t\t\t\t\tnavigator.geolocation.watchPosition(function(position) {\n\t\t\t\t\t\tvar geocoder = new google.maps.Geocoder();\n\t\t\t\t\t\tgeocoder.geocode({\n\t\t\t\t\t\t\"location\": {lat: position.coords.latitude, lng: position.coords.longitude}\n\t\t\t\t\t\t}, function(results, status) {\n\t\t\t\t\t\t\t$(\".findInput input\").val(results[3].formatted_address);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcontrol.$jplistBox.trigger('jumpEvent', [position.coords.latitude, position.coords.longitude, control.$control.data('jplist-autocomplete-zoom')]);\n\t\t\t\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tbutton.hide();\n\t\t\t\t\t\t$('.mapOverlay').addClass('shrink');\n\t\t\t\t\t},\n\t\t\t\t\tfunction(error) {\n\t\t\t\t\t\tif (error.code == error.PERMISSION_DENIED)\n\t\t\t\t\t\t\tconsole.log(\"you denied me :-(\");\n\t\t\t\t\t\t$('.resetGeo').css({'display':'inline-block'});\n\t\t\t\t\t});\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\talert('Your browser does not support geolocation.');\n\t\t\t}\n\n\t\t\t\n\t\t});\n\n\t\tvar autocomplete, zoom, options = {};\n\n\t\tif (control.controlTypeOptions) {\n\t\t\toptions = control.controlTypeOptions;\n\t\t}\n\n\t\t//init autocomplete\n\t\tautocomplete = new google.maps.places.Autocomplete(control.$control.get(0), options);\n\n\t\t//init zoom\n\t\tzoom = Number(control.$control.attr('data-zoom'));\n\n\t\tif (isNaN(zoom)) {\n\t\t\tzoom = 17;\n\t\t}\n\n\t\t//add data\n\t\tcontrol.$control.data('jplist-autocomplete', autocomplete);\n\t\tcontrol.$control.data('jplist-autocomplete-zoom', zoom);\n\t};\n\n\n\t/**\n\t * init events\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.initEvents = function(control) {\n\n\t\t\n\n\t\t\n\t\t$('.search').on('click', function(e){\n\t\t\tif ($('.findInput input').val() !== ''){\n\t\t\tif ($('.pac-container .pac-item-selected')[0]) {\n\t\t\t\t\t\tselectFirstResult($('.pac-item-selected'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectFirstResult($('.pac-container .pac-item:first'));\n\t\t\t\t\t}\n\t\t\t\t\t$('.mapOverlay').addClass('shrink');\t\n\t\t\t}\n\t\t\t\n\t\t});\n\n\n\t\t// Handle Enter on search location \n\t\t$('.findInput input').focusin(function() {\n\n\t\t\t$(document).keypress(function(e) {\n\t\t\t\tif (e.which == 13) {\n\t\t\t\t\tif ($('.pac-container .pac-item-selected')[0]) {\n\t\t\t\t\t\tselectFirstResult($('.pac-item-selected'));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectFirstResult($('.pac-container .pac-item:first'));\n\t\t\t\t\t}\n\t\t\t\t\t$('.mapOverlay').addClass('shrink');\n\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// $('.searchIt').on('click', function(e){\n\t\t// \tselectFirstResult($('.pac-container .pac-item:first'));\n\t\t// });\n\t\tfunction selectFirstResult(result) {\n\t\t\t$(\".pac-container\").hide();\n\t\t\tvar firstResult = result.text();\n\n\t\t\tvar geocoder = new google.maps.Geocoder();\n\n\n\t\t\tgeocoder.geocode({\n\t\t\t\t\"address\": firstResult\n\t\t\t}, function(results, status) {\n\t\t\t\tif (status == google.maps.GeocoderStatus.OK) {\n\t\t\t\t\tvar lat = results[0].geometry.location.lat(),\n\t\t\t\t\t\tlng = results[0].geometry.location.lng(),\n\t\t\t\t\t\tplaceName = results[0].address_components[0].long_name,\n\t\t\t\t\t\tformattedAddress = results[0].formatted_address;\n\t\t\t\t\t$(\".findInput input\").val(formattedAddress);\n\t\t\t\t\tcontrol.$control.attr('data-latitude', lat);\n\t\t\t\t\tcontrol.$control.attr('data-longitude', lng);\n\t\t\t\t\tcontrol.$control.attr('data-name', placeName);\n\t\t\t\t\tcontrol.$jplistBox.trigger('jumpEvent', [lat, lng, control.$control.data('jplist-autocomplete-zoom')]);\n\t\t\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar autocomplete, listenerHandle = control.$control.data('jplist-handle');\n\n\t\t//get autocomplete\n\t\tautocomplete = control.$control.data('jplist-autocomplete');\n\n\t\t//remove listener\n\t\tif (listenerHandle) {\n\t\t\tgoogle.maps.event.removeListener(listenerHandle);\n\t\t}\n\n\t\t//add listener\n\t\tlistenerHandle = google.maps.event.addListener(autocomplete, 'place_changed', function() {\n\n\t\t\tvar place, lat, lng;\n\n\t\t\t//get choosen place\n\t\t\tplace = autocomplete.getPlace();\n\n\t\t\t//set latitude and longitude\n\t\t\tif (place.geometry) {\n\n\t\t\t\tlat = place.geometry.location['lat']();\n\t\t\t\tlng = place.geometry.location['lng']();\n\n\t\t\t\tcontrol.$control.attr('data-latitude', lat);\n\t\t\t\tcontrol.$control.attr('data-longitude', lng);\n\t\t\t\tcontrol.$control.attr('data-name', place.name);\n\t\t\t\tconsole.log(place.name);\n\t\t\t\t$('.mapOverlay').addClass('shrink');\n\n\t\t\t\t//trigger jump to map event\n\t\t\t\tcontrol.$jplistBox.trigger('jumpEvent', [lat, lng, control.$control.data('jplist-autocomplete-zoom')]);\n\t\t\t}\n\n\t\t\t//send panel redraw event\n\t\t\tconsole.log('redraw');\n\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\n\t\t});\n\n\t\tcontrol.$control.off('keyup').on('keyup', function(e) {\n\n\t\t\tvar val;\n\n\t\t\t//get val\n\t\t\tval = $.trim($(this).val());\n\n\t\t\tif (val === '') {\n\t\t\t\tconsole.log('blank');\n\t\t\t\tcontrol.$control.attr('data-latitude', '');\n\t\t\t\tcontrol.$control.attr('data-longitude', '');\n\n\t\t\t\t//send panel redraw event\n\t\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\t\t\t}\n\t\t});\n\n\t\t//save handler\n\t\tcontrol.$control.data('jplist-handle', listenerHandle);\n\t};\n\n\t/**\n\t * Set control status\n\t * @param {jQuery.fn.jplist.models.Status} status\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @param {boolean} isCookie - is status restored from cookies\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.setStatus = function(status, control, isCookie) {\n\n\t\t//console.log(status.data);\n\t};\n\n\t/**\n\t * get current control status\n\t * @param {boolean} isDefault - if true, get default (initial) control status; else - get current control status\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @return {jQuery.fn.jplist.models.Status}\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.getStatus = function(isDefault, control) {\n\n\t\tvar status = null,\n\t\t\tlatitude, longitude, data;\n\n\t\t//get attributes\n\t\tlatitude = control.$control.attr('data-latitude');\n\t\tlongitude = control.$control.attr('data-longitude');\n\n\t\tdata = {\n\t\t\tname: control.$control.attr('data-name'),\n\t\t\tradius: control.$control.attr('data-radius'),\n\t\t\tfilterType: 'autocomplete'\n\t\t};\n\n\t\tif (isDefault) {\n\n\t\t\tdata.latitude = '';\n\t\t\tdata.longitude = '';\n\n\t\t\tstatus = new jQuery.fn.jplist.models.Status(control.name, control.action, control.type, data, true);\n\t\t} else {\n\t\t\tif ($.isNumeric(latitude) && $.isNumeric(longitude)) {\n\n\t\t\t\tdata.latitude = latitude;\n\t\t\t\tdata.longitude = longitude;\n\t\t\t\tstatus = new jQuery.fn.jplist.models.Status(control.name, control.action, control.type, data, true);\n\t\t\t}\n\t\t}\n\n\t\treturn status;\n\t};\n\n\n\n})(jQuery);"],"sourceRoot":"/source/"}