{"version":3,"sources":["map/jlocator/controls/autocomplete.js"],"names":[],"mappings":"aAAA,CAAC,SAAS,CAAT,CAAY,CACZ;;;;;;IADY,MAUZ,CAAO,EAAP,CAAU,MAAV,CAAiB,QAAjB,CAA0B,YAA1B,CAAyC,EAAzC;;;;IAVY,MAiBZ,CAAO,EAAP,CAAU,MAAV,CAAiB,QAAjB,CAA0B,YAA1B,CAAuC,MAAvC,CAAgD,SAAS,OAAT,CAAkB,CAEjE,IAAI,YAAJ,CAAkB,IAAlB,CAAwB,QAAU,EAAV,CAFyC,GAI7D,QAAQ,kBAAR,CAA4B,CAC/B,QAAU,QAAQ,kBAAR,CADqB,CAAhC;AAJiE,YASjE,CAAe,IAAI,OAAO,IAAP,CAAY,MAAZ,CAAmB,YAAnB,CAAgC,QAAQ,QAAR,CAAiB,GAAjB,CAAqB,CAArB,CAApC,CAA6D,OAA7D,CAAf;AATiE,IAYjE,CAAO,OAAO,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,WAAtB,CAAP,CAAP,CAZiE,GAc7D,MAAM,IAAN,CAAJ,CAAiB,CAChB,KAAO,EAAP,CADgB,CAAjB;AAdiE,OAmBjE,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,qBAAtB,CAA6C,YAA7C,EAnBiE,OAoBjE,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,0BAAtB,CAAkD,IAAlD,EApBiE,CAAlB;;;;IAjBpC,MA6CZ,CAAO,EAAP,CAAU,MAAV,CAAiB,QAAjB,CAA0B,YAA1B,CAAuC,UAAvC,CAAoD,SAAS,OAAT,CAAkB;AAGrE,EAAE,kBAAF,EAAsB,OAAtB,CAA8B,UAAW,CACxC,EAAE,QAAF,EAAY,QAAZ,CAAqB,SAAS,CAAT,CAAY,CAChC,GAAI,EAAE,KAAF,EAAW,EAAX,CAAe,CAClB,GAAI,EAAE,mCAAF,EAAuC,CAAvC,CAAJ,CAA+C,CAC9C,kBAAkB,EAAE,oBAAF,CAAlB,EAD8C,OAE9C,CAAQ,GAAR,CAAY,yBAAZ,EAF8C,CAA/C,KAGO,CACN,kBAAkB,EAAE,gCAAF,CAAlB,EADM,OAEN,CAAQ,GAAR,CAAY,kBAAZ,EAFM,CAHP,CAOA,CAAE,aAAF,EAAiB,QAAjB,CAA0B,QAA1B,EARkB,CAAnB,CADoB,CAArB,CADwC,CAAX,CAA9B;;;AAHqE,SAsB5D,iBAAT,CAA2B,MAA3B,CAAmC,CAClC,EAAE,gBAAF,EAAoB,IAApB,GADkC,IAE9B,YAAc,OAAO,IAAP,EAAd,CAF8B,IAI9B,SAAW,IAAI,OAAO,IAAP,CAAY,QAAZ,EAAf,CAJ8B,QAOlC,CAAS,OAAT,CAAiB,CAChB,UAAW,WAAX,CADD,CAEG,SAAS,OAAT,CAAkB,MAAlB,CAA0B,CAC5B,GAAI,QAAU,OAAO,IAAP,CAAY,cAAZ,CAA2B,EAA3B,CAA+B,CAC5C,QAAQ,GAAR,CAAY,OAAZ,EAD4C,IAExC,IAAM,QAAQ,CAAR,EAAW,QAAX,CAAoB,QAApB,CAA6B,GAA7B,EAAN,CACH,IAAM,QAAQ,CAAR,EAAW,QAAX,CAAoB,QAApB,CAA6B,GAA7B,EAAN,CACA,UAAY,QAAQ,CAAR,EAAW,kBAAX,CAA8B,CAA9B,EAAiC,SAAjC,CACZ,iBAAmB,QAAQ,CAAR,EAAW,iBAAX,CALwB,CAM5C,CAAE,kBAAF,EAAsB,GAAtB,CAA0B,gBAA1B,EAN4C,OAO5C,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,eAAtB,CAAuC,GAAvC,EAP4C,OAQ5C,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,gBAAtB,CAAwC,GAAxC,EAR4C,OAS5C,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,WAAtB,CAAmC,SAAnC,EAT4C,OAU5C,CAAQ,UAAR,CAAmB,OAAnB,CAA2B,WAA3B,CAAwC,CAAC,GAAD,CAAM,GAAN,CAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,0BAAtB,CAAX,CAAxC,EAV4C,OAW5C,CAAQ,UAAR,CAAmB,OAAnB,CAA2B,QAAQ,OAAR,CAAgB,eAAhB,CAAiC,CAAC,KAAD,CAA5D,EAX4C,CAA7C,CADE,CAFH,CAPkC,CAAnC,IA0BI,YAAJ,CAAkB,eAAiB,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,eAAtB,CAAjB;AAhDmD,YAmDrE,CAAe,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,qBAAtB,CAAf;AAnDqE,GAsDjE,cAAJ,CAAoB,CACnB,OAAO,IAAP,CAAY,KAAZ,CAAkB,cAAlB,CAAiC,cAAjC,EADmB,CAApB;AAtDqE,cA2DrE,CAAiB,OAAO,IAAP,CAAY,KAAZ,CAAkB,WAAlB,CAA8B,YAA9B,CAA4C,eAA5C,CAA6D,UAAW,CAExF,IAAI,KAAJ,CAAW,GAAX,CAAgB,GAAhB;AAFwF,KAKxF,CAAQ,aAAa,QAAb,EAAR;AALwF,GAQpF,MAAM,QAAN,CAAgB,CAEnB,IAAM,MAAM,QAAN,CAAe,QAAf,CAAwB,KAAxB,GAAN,CAFmB,GAGnB,CAAM,MAAM,QAAN,CAAe,QAAf,CAAwB,KAAxB,GAAN,CAHmB,OAKnB,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,eAAtB,CAAuC,GAAvC,EALmB,OAMnB,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,gBAAtB,CAAwC,GAAxC,EANmB,OAOnB,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,WAAtB,CAAmC,MAAM,IAAN,CAAnC,CAPmB,OAQnB,CAAQ,GAAR,CAAY,MAAM,IAAN,CAAZ;AARmB,OAWnB,CAAQ,UAAR,CAAmB,OAAnB,CAA2B,WAA3B,CAAwC,CAAC,GAAD,CAAM,GAAN,CAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,0BAAtB,CAAX,CAAxC,EAXmB,CAApB;AARwF,OAuBxF,CAAQ,GAAR,CAAY,QAAZ,EAvBwF,OAwBxF,CAAQ,UAAR,CAAmB,OAAnB,CAA2B,QAAQ,OAAR,CAAgB,eAAhB,CAAiC,CAAC,KAAD,CAA5D,EAxBwF,CAAX,CAA9E,CA3DqE,OAuFrE,CAAQ,QAAR,CAAiB,GAAjB,CAAqB,OAArB,EAA8B,EAA9B,CAAiC,OAAjC,CAA0C,SAAS,CAAT,CAAY,CAErD,IAAI,GAAJ;AAFqD,GAKrD,CAAM,EAAE,IAAF,CAAO,EAAE,IAAF,EAAQ,GAAR,EAAP,CAAN,CALqD,GAOjD,MAAQ,EAAR,CAAY,CACf,QAAQ,GAAR,CAAY,OAAZ,EADe,OAEf,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,eAAtB,CAAuC,EAAvC,EAFe,OAGf,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,gBAAtB,CAAwC,EAAxC;AAHe,OAMf,CAAQ,UAAR,CAAmB,OAAnB,CAA2B,QAAQ,OAAR,CAAgB,eAAhB,CAAiC,CAAC,KAAD,CAA5D,EANe,CAAhB,CAPyC,CAA1C;AAvFqE,OAyGrE,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,eAAtB,CAAuC,cAAvC,EAzGqE,CAAlB;;;;;;IA7CxC,MAgKZ,CAAO,EAAP,CAAU,MAAV,CAAiB,QAAjB,CAA0B,YAA1B,CAAuC,SAAvC,CAAmD,SAAS,MAAT,CAAiB,OAAjB,CAA0B,QAA1B,CAAoC;CAApC;;;;;;IAhKvC,MA4KZ,CAAO,EAAP,CAAU,MAAV,CAAiB,QAAjB,CAA0B,YAA1B,CAAuC,SAAvC,CAAmD,SAAS,SAAT,CAAoB,OAApB,CAA6B,CAE/E,IAAI,OAAS,IAAT,CACH,QADD,CACW,SADX,CACsB,IADtB;AAF+E,QAM/E,CAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,eAAtB,CAAX,CAN+E,SAO/E,CAAY,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,gBAAtB,CAAZ,CAP+E,IAS/E,CAAO,CACN,KAAM,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,WAAtB,CAAN,CACA,OAAQ,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,aAAtB,CAAR,CACA,WAAY,cAAZ,CAHD,CAT+E,GAe3E,SAAJ,CAAe,CAEd,KAAK,QAAL,CAAgB,EAAhB,CAFc,IAGd,CAAK,SAAL,CAAiB,EAAjB,CAHc,MAKd,CAAS,IAAI,OAAO,EAAP,CAAU,MAAV,CAAiB,MAAjB,CAAwB,MAAxB,CAA+B,QAAQ,IAAR,CAAc,QAAQ,MAAR,CAAgB,QAAQ,IAAR,CAAc,IAA/E,CAAqF,IAArF,CAAT,CALc,CAAf,KAMO,CACN,GAAI,EAAE,SAAF,CAAY,QAAZ,GAAyB,EAAE,SAAF,CAAY,SAAZ,CAAzB,CAAiD,CAEpD,KAAK,QAAL,CAAgB,QAAhB,CAFoD,IAGpD,CAAK,SAAL,CAAiB,SAAjB,CAHoD,MAIpD,CAAS,IAAI,OAAO,EAAP,CAAU,MAAV,CAAiB,MAAjB,CAAwB,MAAxB,CAA+B,QAAQ,IAAR,CAAc,QAAQ,MAAR,CAAgB,QAAQ,IAAR,CAAc,IAA/E,CAAqF,IAArF,CAAT,CAJoD,CAArD,CAPD,OAeO,MAAP,CA9B+E,CAA7B,CA5KvC,CAAZ,CAAD,CA+MG,MA/MH","file":"map/jlocator/controls/autocomplete.js","sourcesContent":["(function($) {\n\t'use strict';\n\n\t/** \n\t * autocomplete control\n\t * @type {Object} \n\t * @name Autocomplete\n\t * @class autocomplete Control\n\t * @memberOf jQuery.fn.jplist.controls\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete = {};\n\n\t/**\n\t * render control html\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.render = function(control) {\n\n\t\tvar autocomplete, zoom, options = {};\n\n\t\tif (control.controlTypeOptions) {\n\t\t\toptions = control.controlTypeOptions;\n\t\t}\n\n\t\t//init autocomplete\n\t\tautocomplete = new google.maps.places.Autocomplete(control.$control.get(0), options);\n\n\t\t//init zoom\n\t\tzoom = Number(control.$control.attr('data-zoom'));\n\n\t\tif (isNaN(zoom)) {\n\t\t\tzoom = 17;\n\t\t}\n\n\t\t//add data\n\t\tcontrol.$control.data('jplist-autocomplete', autocomplete);\n\t\tcontrol.$control.data('jplist-autocomplete-zoom', zoom);\n\t};\n\n\t/**\n\t * init events\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.initEvents = function(control) {\n\n\t\t// Handle Enter on search location \n\t\t$('.findInput input').focusin(function() {\n\t\t\t$(document).keypress(function(e) {\n\t\t\t\tif (e.which == 13) {\n\t\t\t\t\tif ($('.pac-container .pac-item-selected')[0]) {\n\t\t\t\t\t\tselectFirstResult($('.pac-item-selected'));\n\t\t\t\t\t\tconsole.log('item selected after row')\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectFirstResult($('.pac-container .pac-item:first'));\n\t\t\t\t\t\tconsole.log('first item enter')\n\t\t\t\t\t}\n\t\t\t\t\t$('.mapOverlay').addClass('shrink');\n\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// $('.searchIt').on('click', function(e){\n\t\t// \tselectFirstResult($('.pac-container .pac-item:first'));\n\t\t// });\n\t\tfunction selectFirstResult(result) {\n\t\t\t$(\".pac-container\").hide();\n\t\t\tvar firstResult = result.text();\n\n\t\t\tvar geocoder = new google.maps.Geocoder();\n\n\n\t\t\tgeocoder.geocode({\n\t\t\t\t\"address\": firstResult\n\t\t\t}, function(results, status) {\n\t\t\t\tif (status == google.maps.GeocoderStatus.OK) {\n\t\t\t\t\tconsole.log(results);\n\t\t\t\t\tvar lat = results[0].geometry.location.lat(),\n\t\t\t\t\t\tlng = results[0].geometry.location.lng(),\n\t\t\t\t\t\tplaceName = results[0].address_components[0].long_name,\n\t\t\t\t\t\tformattedAddress = results[0].formatted_address;\n\t\t\t\t\t$(\".findInput input\").val(formattedAddress);\n\t\t\t\t\tcontrol.$control.attr('data-latitude', lat);\n\t\t\t\t\tcontrol.$control.attr('data-longitude', lng);\n\t\t\t\t\tcontrol.$control.attr('data-name', placeName);\n\t\t\t\t\tcontrol.$jplistBox.trigger('jumpEvent', [lat, lng, control.$control.data('jplist-autocomplete-zoom')]);\n\t\t\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tvar autocomplete, listenerHandle = control.$control.data('jplist-handle');\n\n\t\t//get autocomplete\n\t\tautocomplete = control.$control.data('jplist-autocomplete');\n\n\t\t//remove listener\n\t\tif (listenerHandle) {\n\t\t\tgoogle.maps.event.removeListener(listenerHandle);\n\t\t}\n\n\t\t//add listener\n\t\tlistenerHandle = google.maps.event.addListener(autocomplete, 'place_changed', function() {\n\n\t\t\tvar place, lat, lng;\n\n\t\t\t//get choosen place\n\t\t\tplace = autocomplete.getPlace();\n\n\t\t\t//set latitude and longitude\n\t\t\tif (place.geometry) {\n\n\t\t\t\tlat = place.geometry.location['lat']();\n\t\t\t\tlng = place.geometry.location['lng']();\n\n\t\t\t\tcontrol.$control.attr('data-latitude', lat);\n\t\t\t\tcontrol.$control.attr('data-longitude', lng);\n\t\t\t\tcontrol.$control.attr('data-name', place.name);\n\t\t\t\tconsole.log(place.name);\n\n\t\t\t\t//trigger jump to map event\n\t\t\t\tcontrol.$jplistBox.trigger('jumpEvent', [lat, lng, control.$control.data('jplist-autocomplete-zoom')]);\n\t\t\t}\n\n\t\t\t//send panel redraw event\n\t\t\tconsole.log('redraw');\n\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\n\t\t});\n\n\t\tcontrol.$control.off('keyup').on('keyup', function(e) {\n\n\t\t\tvar val;\n\n\t\t\t//get val\n\t\t\tval = $.trim($(this).val());\n\n\t\t\tif (val === '') {\n\t\t\t\tconsole.log('blank');\n\t\t\t\tcontrol.$control.attr('data-latitude', '');\n\t\t\t\tcontrol.$control.attr('data-longitude', '');\n\n\t\t\t\t//send panel redraw event\n\t\t\t\tcontrol.$jplistBox.trigger(control.options.force_ask_event, [false]);\n\t\t\t}\n\t\t});\n\n\t\t//save handler\n\t\tcontrol.$control.data('jplist-handle', listenerHandle);\n\t};\n\n\t/**\n\t * Set control status\n\t * @param {jQuery.fn.jplist.models.Status} status\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @param {boolean} isCookie - is status restored from cookies\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.setStatus = function(status, control, isCookie) {\n\n\t\t//console.log(status.data);\n\t};\n\n\t/**\n\t * get current control status\n\t * @param {boolean} isDefault - if true, get default (initial) control status; else - get current control status\n\t * @param {jQuery.fn.jplist.view.PanelControl} control\n\t * @return {jQuery.fn.jplist.models.Status}\n\t * @memberOf jQuery.fn.jplist.controls.Autocomplete\n\t */\n\tjQuery.fn.jplist.controls.Autocomplete.getStatus = function(isDefault, control) {\n\n\t\tvar status = null,\n\t\t\tlatitude, longitude, data;\n\n\t\t//get attributes\n\t\tlatitude = control.$control.attr('data-latitude');\n\t\tlongitude = control.$control.attr('data-longitude');\n\n\t\tdata = {\n\t\t\tname: control.$control.attr('data-name'),\n\t\t\tradius: control.$control.attr('data-radius'),\n\t\t\tfilterType: 'autocomplete'\n\t\t};\n\n\t\tif (isDefault) {\n\n\t\t\tdata.latitude = '';\n\t\t\tdata.longitude = '';\n\n\t\t\tstatus = new jQuery.fn.jplist.models.Status(control.name, control.action, control.type, data, true);\n\t\t} else {\n\t\t\tif ($.isNumeric(latitude) && $.isNumeric(longitude)) {\n\n\t\t\t\tdata.latitude = latitude;\n\t\t\t\tdata.longitude = longitude;\n\t\t\t\tstatus = new jQuery.fn.jplist.models.Status(control.name, control.action, control.type, data, true);\n\t\t\t}\n\t\t}\n\n\t\treturn status;\n\t};\n\n\n\n})(jQuery);"],"sourceRoot":"/source/"}