{"version":3,"sources":["map/jlocator/view/panel.js"],"names":[],"mappings":"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","file":"map/jlocator/view/panel.js","sourcesContent":["(function($){\n\t'use strict';\t\t\n\t\n\t/**\n\t* enable direction label (autocomplete etc.)\n\t* @param {Object} self - this object\n\t* @param {jQueryObject} $directionLabel - directions label\n\t* @param {jQueryObject} $input - directions input field\n\t* @param {number} latitude\n\t* @param {number} longitude\n\t*/\n\tvar enableDirectionLabel = function(self, $directionLabel, $input, latitude, longitude){\n\t\t\n\t\tvar autocomplete\n\t\t\t,listenerHandle;\n\t\t\n\t\t//add data attribute\n\t\t$directionLabel.attr('data-enabled', 'true');\n\t\t\n\t\tif($input.length > 0){\n\t\t\t\t\n\t\t\t//init input autocomplete\n\t\t\tautocomplete = new google.maps.places.Autocomplete($input.get(0));\n\t\t\tautocomplete.jlocator = {\n\t\t\t\tlatitude: latitude\n\t\t\t\t,longitude: longitude\n\t\t\t};\n\t\t\t\n\t\t\t//autocomplete listener\n\t\t\tlistenerHandle = google.maps.event.addListener(autocomplete, 'place_changed', function(){\n\t\t\n\t\t\t\tvar place\n\t\t\t\t\t,start\n\t\t\t\t\t,end\n\t\t\t\t\t,jlocator;\n\t\t\t\t\n\t\t\t\t//get jlocator data\n\t\t\t\tjlocator = this['jlocator'];\n\t\t\t\t\n\t\t\t\t//get choosen place\n\t\t\t\tplace = autocomplete.getPlace();\t\t\t\t\t\n\t\t\t\t\n\t\t\t\tif(place && place.geometry){\n\t\t\t\t\n\t\t\t\t\t//get points\n\t\t\t\t\tstart = new google.maps.LatLng(jlocator['latitude'], jlocator['longitude']);\n\t\t\t\t\tend = new google.maps.LatLng(place.geometry.location[\"lat\"](), place.geometry.location[\"lng\"]());\n\t\t\t\t\t\n\t\t\t\t\t//trigger set directions event\n\t\t\t\t\tself.$root.trigger(self.options.setDirectionsEvent, [start, end]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\t\n\t/**\n\t* init directions events\n\t* @param {Object} self - this object\n\t* @param {jQueryObject} $directionLabel\n\t*/\n\tvar initDirectionEvents = function(self, $directionLabel){\n\t\t\n\t\tvar $dataItem\n\t\t\t,latitude\n\t\t\t,longitude\n\t\t\t,$input\n\t\t\t,isVisible\n\t\t\t,enabled;\n\t\t\n\t\t//close all inputs\n\t\tself.$panelRoot.find('[data-type=\"directions-input\"]').hide(0);\n\t\t\t\t\n\t\tif($directionLabel.length > 0){\n\t\t\t\n\t\t\t//get vars\n\t\t\tenabled = $directionLabel.attr('data-enabled');\n\t\t\t$dataItem = $directionLabel.parents('[data-type=\"store\"]');\n\t\t\t$input = $dataItem.find('[data-type=\"directions-input\"]');\n\t\t\t\n\t\t\t//if direcion label is not enabled -> enable it (autocomplete, its handler etc.)\n\t\t\tif(!enabled && $dataItem.length > 0){\n\t\t\t\t\n\t\t\t\t//get vars\n\t\t\t\tlatitude = Number($dataItem.attr('data-latitude'));\n\t\t\t\tlongitude = Number($dataItem.attr('data-longitude'));\n\t\t\t\t\n\t\t\t\tif(!isNaN(latitude) && !isNaN(longitude)){\t\t\t\t\t\n\t\t\t\t\tenableDirectionLabel(self, $directionLabel, $input, latitude, longitude);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif($input.length > 0){\n\n\t\t\t\tisVisible = $input.is(':visible');\n\t\t\t\t\n\t\t\t\tif(isVisible){\n\t\t\t\t\t$input.hide(0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t$input.show(0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t\n\t/**\n\t* init events\n\t* @param {Object} self - 'this' object\n\t*/\n\tvar initEvents = function(self){\n\t\t\n\t\t/**\n\t\t* store onclick\n\t\t*/\n\t\tself.$root.on('click', '[data-type=\"stores\"] [data-type=\"store\"]', function(){\n\t\t\t\n\t\t\tvar store\n\t\t\t\t,$store;\n\t\t\t\n\t\t\t$store = $(this);\n\t\t\t\n\t\t\t//init store\n\t\t\tstore = new jQuery.fn.jlocator.store($store, self.options);\n\t\t\t\n\t\t\t//trigger event\n\t\t\tself.$root.trigger(self.options.storeClickEvent, [store]);\n\t\t\t\n\t\t\t//remove active class from all current visible stores\n\t\t\tself.$panelRoot.find('[data-type=\"stores\"] [data-type=\"store\"]').removeClass('active');\n\t\t\t\n\t\t\t//add active class to the current store\n\t\t\t$store.addClass('active');\n\t\t});\n\t\t\n\t\t/**\n\t\t* get stores list event\n\t\t*/\n\t\tself.$root.on(self.options.getStoresListEvent, function(){\n\t\t\t\n\t\t\t//trigger send stores list event\n\t\t\tself.$root.trigger(self.options.sendStoreListEvent, [self.stores, getStoresView(self)]);\n\t\t});\n\t\t\n\t\t/**\n\t\t* init direction events\n\t\t*/\n\t\tself.$root.on('click', '[data-type=\"directions-label\"]', function(){\t\t\t\n\t\t\tinitDirectionEvents(self, $(this));\n\t\t});\n\t\t\n\t\t/**\n\t\t* bind map pin click event\n\t\t*/\n\t\tself.$root.on(self.options.pinClickEvent, function(e, store){\n\t\t\t\n\t\t\tvar longitude = store.longitude\n\t\t\t\t,latitude = store.latitude\n\t\t\t\t,$store\n\t\t\t\t,$stores;\n\t\t\t\t\n\t\t\tif($.isNumeric(longitude) && $.isNumeric(latitude)){\n\t\t\t\t\n\t\t\t\t//get all visible stores\n\t\t\t\t$stores = self.$panelRoot.find('[data-type=\"stores\"] [data-type=\"store\"]');\n\t\t\t\n\t\t\t\t//get store\n\t\t\t\t$store = $stores.filter('[data-longitude=\"' + longitude + '\"][data-latitude=\"' + latitude + '\"]');\n\t\t\t\t\n\t\t\t\tif($store.length > 0){\n\t\t\t\t\t\n\t\t\t\t\t$stores.removeClass('active');\n\t\t\t\t\t$store.addClass('active');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\t\n\t/**\n\t* get stores view (current store list)\n\t* @param {Object} self - 'this' object\n\t* @return {Array.<jQuery.fn.jlocator.store>} - stores view (current store list)\n\t*/\n\tvar getStoresView = function(self){\n\t\t\n\t\tvar store\n\t\t\t,storesView = [];\n\t\t\n\t\tself.$panelRoot.find('[data-type=\"stores\"] [data-type=\"store\"]').each(function(){\n\t\t\t\t\t\t\n\t\t\t//init store\n\t\t\tstore = new jQuery.fn.jlocator.store($(this), self.options);\n\t\t\t\n\t\t\tstoresView.push(store);\n\t\t});\n\t\t\n\t\treturn storesView;\n\t};\n\t\n\t/**\n\t* init full stores list\n\t* @param {Object} self - 'this' object\n\t* @return {Array.<jQuery.fn.jlocator.store>} - full stores list\n\t*/\n\tvar initStoresList = function(self){\n\t\t\n\t\tvar store\n\t\t\t,stores = [];\n\t\t\n\t\tself.$stores.each(function(){\n\t\t\t\t\t\t\n\t\t\t//init store\n\t\t\tstore = new jQuery.fn.jlocator.store($(this), self.options);\n\t\t\t\n\t\t\tstores.push(store);\n\t\t});\n\t\t\n\t\treturn stores;\n\t};\n\t\n\t/**\n\t* init jplist plugin: http://jplist.no81no.com/\n\t* @param {Object} self - 'this' object\n\t* @param {jQueryObject} $root - jlocator root element\n\t*/\n\tvar initJPlist = function(self, $root){\n\t\t\n\t\tvar saveCallback = self.options.jplist.redraw_callback;\n\t\t\n\t\tif($root.length > 0){\n\t\t\n\t\t\tself.options.jplist.redraw_callback = function(){\n\t\t\t\t\n\t\t\t\tif($.isFunction(saveCallback)){\n\t\t\t\t\tsaveCallback();\n\t\t\t\t\t\n\t\t\t\t\t//trigger send stores list event\n\t\t\t\t\tself.$root.trigger(self.options.sendStoreListEvent, [self.stores, getStoresView(self)]);\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\t$root.jplist(self.options.jplist);\n\t\t}\n\t};\n\t\n\t/**\n\t* panel constructor\n\t* @param {jQueryObject} $root - jlocator root element\n\t* @param {Object} options - jlocator user options\n\t* @return {Object} - panel + this\t\n\t* @constructor \n\t*/\n\tvar Init = function($root, options){\n\t\n\t\tvar self = {\n\t\t\t$root: $root\n\t\t\t,options: options\n\t\t\t,stores: []\n\t\t\t\n\t\t\t//elements\n\t\t\t,$panelRoot: $root.find('[data-type=\"panel\"]')\n\t\t\t,$stores: null\n\t\t};\t\n\n\t\t//init vars\n\t\tself.$stores = self.$panelRoot.find('[data-type=\"stores\"] [data-type=\"store\"]');\n\t\t\n\t\t//init store list\n\t\tself.stores = initStoresList(self);\n\t\t\n\t\t//init jplist plugin\n\t\tinitJPlist(self, self.$root);\n\t\t\t\t\n\t\treturn $.extend(this, self);\n\t};\n\t\n\t/**\n\t* panel constructor\n\t* @param {jQueryObject} $root - jlocator root element\n\t* @param {Object} options - jlocator user options\n\t* @return {Object} - panel\n\t* @constructor \n\t* @name panel\n    * @class Controller\n    * @memberOf jQuery.fn.jlocator\n\t* @property {jQueryObject} $root - jlocator root element\n\t* @property {Object} options - jlocator user options\n\t* @property {Array.<jQuery.fn.jlocator.store>} stores - jlocator stores array\n\t* @property {jQueryObject} $panelRoot - panel root element\n\t* @property {jQueryObject} $stores - stores list as jquery element\n\t*/\n\tjQuery.fn.jlocator.panel = function($root, options){\n\t\t\t\t\n\t\t//call constructor\n\t\tvar self = new Init($root, options);\t\n\n\t\t//init events\n\t\tinitEvents(self);\n\t\t\n\t\treturn self;\n\t};\n})(jQuery);\n\n"],"sourceRoot":"/source/"}