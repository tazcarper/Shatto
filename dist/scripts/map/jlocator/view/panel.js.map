{"version":3,"sources":["map/jlocator/view/panel.js"],"names":[],"mappings":"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","file":"map/jlocator/view/panel.js","sourcesContent":["(function($){\n\t'use strict';\t\t\n\t\n\t/**\n\t* enable direction label (autocomplete etc.)\n\t* @param {Object} self - this object\n\t* @param {jQueryObject} $directionLabel - directions label\n\t* @param {jQueryObject} $input - directions input field\n\t* @param {number} latitude\n\t* @param {number} longitude\n\t*/\n\tvar enableDirectionLabel = function(self, $directionLabel, $input, latitude, longitude){\n\t\t\n\t\tvar autocomplete\n\t\t\t,listenerHandle;\n\t\t\n\t\t//add data attribute\n\t\t$directionLabel.attr('data-enabled', 'true');\n\t\t\n\t\tif($input.length > 0){\n\t\t\t\t\n\t\t\t//init input autocomplete\n\t\t\tautocomplete = new google.maps.places.Autocomplete($input.get(0));\n\t\t\tautocomplete.jlocator = {\n\t\t\t\tlatitude: latitude\n\t\t\t\t,longitude: longitude\n\t\t\t};\n\t\t\t\n\t\t\t//autocomplete listener\n\t\t\tlistenerHandle = google.maps.event.addListener(autocomplete, 'place_changed', function(){\n\t\t\n\t\t\t\tvar place\n\t\t\t\t\t,start\n\t\t\t\t\t,end\n\t\t\t\t\t,jlocator;\n\t\t\t\t\n\t\t\t\t//get jlocator data\n\t\t\t\tjlocator = this['jlocator'];\n\t\t\t\t\n\t\t\t\t//get choosen place\n\t\t\t\tplace = autocomplete.getPlace();\t\t\t\t\t\n\t\t\t\t\n\t\t\t\tif(place && place.geometry){\n\t\t\t\t\n\t\t\t\t\t//get points\n\t\t\t\t\tstart = new google.maps.LatLng(jlocator['latitude'], jlocator['longitude']);\n\t\t\t\t\tend = new google.maps.LatLng(place.geometry.location[\"lat\"](), place.geometry.location[\"lng\"]());\n\t\t\t\t\t\n\t\t\t\t\t//trigger set directions event\n\t\t\t\t\tself.$root.trigger(self.options.setDirectionsEvent, [start, end]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\t\n\t/**\n\t* init directions events\n\t* @param {Object} self - this object\n\t* @param {jQueryObject} $directionLabel\n\t*/\n\tvar initDirectionEvents = function(self, $directionLabel){\n\t\t\n\t\tvar $dataItem\n\t\t\t,latitude\n\t\t\t,longitude\n\t\t\t,$input\n\t\t\t,isVisible\n\t\t\t,enabled;\n\t\t\n\t\t//close all inputs\n\t\tself.$panelRoot.find('[data-type=\"directions-input\"]').hide(0);\n\t\t\t\t\n\t\tif($directionLabel.length > 0){\n\t\t\t\n\t\t\t//get vars\n\t\t\tenabled = $directionLabel.attr('data-enabled');\n\t\t\t$dataItem = $directionLabel.parents('[data-type=\"store\"]');\n\t\t\t$input = $dataItem.find('[data-type=\"directions-input\"]');\n\t\t\t\n\t\t\t//if direcion label is not enabled -> enable it (autocomplete, its handler etc.)\n\t\t\tif(!enabled && $dataItem.length > 0){\n\t\t\t\t\n\t\t\t\t//get vars\n\t\t\t\tlatitude = Number($dataItem.attr('data-latitude'));\n\t\t\t\tlongitude = Number($dataItem.attr('data-longitude'));\n\t\t\t\t\n\t\t\t\tif(!isNaN(latitude) && !isNaN(longitude)){\t\t\t\t\t\n\t\t\t\t\tenableDirectionLabel(self, $directionLabel, $input, latitude, longitude);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif($input.length > 0){\n\n\t\t\t\tisVisible = $input.is(':visible');\n\t\t\t\t\n\t\t\t\tif(isVisible){\n\t\t\t\t\t$input.hide(0);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t$input.show(0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t\n\t/**\n\t* init events\n\t* @param {Object} self - 'this' object\n\t*/\n\tvar initEvents = function(self){\n\t\t\n\t\t/**\n\t\t* store onclick\n\t\t*/\n\t\tself.$root.on('click', '[data-type=\"stores\"] [data-type=\"store\"]', function(){\n\t\t\t\n\t\t\tvar store\n\t\t\t\t,$store;\n\t\t\t\n\t\t\t$store = $(this);\n\t\t\t\n\t\t\t//init store\n\t\t\tstore = new jQuery.fn.jlocator.store($store, self.options);\n\t\t\t\n\t\t\t//trigger event\n\t\t\tself.$root.trigger(self.options.storeClickEvent, [store]);\n\t\t\t\n\t\t\t//remove active class from all current visible stores\n\t\t\tself.$panelRoot.find('[data-type=\"stores\"] [data-type=\"store\"]').removeClass('active');\n\t\t\t\n\t\t\t//add active class to the current store\n\t\t\t$store.addClass('active');\n\t\t});\n\t\t\n\t\t/**\n\t\t* get stores list event\n\t\t*/\n\t\tself.$root.on(self.options.getStoresListEvent, function(){\n\t\t\t\n\t\t\t//trigger send stores list event\n\t\t\tself.$root.trigger(self.options.sendStoreListEvent, [self.stores, getStoresView(self)]);\n\t\t});\n\t\t\n\t\t/**\n\t\t* init direction events\n\t\t*/\n\t\tself.$root.on('click', '[data-type=\"directions-label\"]', function(){\t\t\t\n\t\t\tinitDirectionEvents(self, $(this));\n\t\t});\n\t\t\n\t\t/**\n\t\t* bind map pin click event\n\t\t*/\n\t\tself.$root.on(self.options.pinClickEvent, function(e, store){\n\t\t\t\n\t\t\tvar longitude = store.longitude\n\t\t\t\t,latitude = store.latitude\n\t\t\t\t,$store\n\t\t\t\t,$stores;\n\t\t\t\t\n\t\t\tif($.isNumeric(longitude) && $.isNumeric(latitude)){\n\t\t\t\t\n\t\t\t\t//get all visible stores\n\t\t\t\t$stores = self.$panelRoot.find('[data-type=\"stores\"] [data-type=\"store\"]');\n\t\t\t\n\t\t\t\t//get store\n\t\t\t\t$store = $stores.filter('[data-longitude=\"' + longitude + '\"][data-latitude=\"' + latitude + '\"]');\n\t\t\t\t\n\t\t\t\tif($store.length > 0){\n\t\t\t\t\t\n\t\t\t\t\t$stores.removeClass('active');\n\t\t\t\t\t$store.addClass('active');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\t\n\t/**\n\t* get stores view (current store list)\n\t* @param {Object} self - 'this' object\n\t* @return {Array.<jQuery.fn.jlocator.store>} - stores view (current store list)\n\t*/\n\tvar getStoresView = function(self){\n\t\t\n\t\tvar store\n\t\t\t,storesView = [];\n\t\t\n\t\tself.$panelRoot.find('[data-type=\"stores\"] [data-type=\"store\"]').each(function(){\n\t\t\t\t\t\t\n\t\t\t//init store\n\t\t\tstore = new jQuery.fn.jlocator.store($(this), self.options);\n\t\t\t\n\t\t\tstoresView.push(store);\n\t\t});\n\t\t\n\t\treturn storesView;\n\t};\n\t\n\t/**\n\t* init full stores list\n\t* @param {Object} self - 'this' object\n\t* @return {Array.<jQuery.fn.jlocator.store>} - full stores list\n\t*/\n\tvar initStoresList = function(self){\n\t\t\n\t\tvar store\n\t\t\t,stores = [];\n\t\t\n\t\tself.$stores.each(function(){\n\t\t\t\t\t\t\n\t\t\t//init store\n\t\t\tstore = new jQuery.fn.jlocator.store($(this), self.options);\n\t\t\t\n\t\t\tstores.push(store);\n\t\t});\n\t\t\n\t\treturn stores;\n\t};\n\t\n\t/**\n\t* init jplist plugin: http://jplist.no81no.com/\n\t* @param {Object} self - 'this' object\n\t* @param {jQueryObject} $root - jlocator root element\n\t*/\n\tvar initJPlist = function(self, $root){\n\t\t\n\t\tvar saveCallback = self.options.jplist.redraw_callback;\n\t\t\n\t\tif($root.length > 0){\n\t\t\n\t\t\tself.options.jplist.redraw_callback = function(){\n\t\t\t\t\n\t\t\t\tif($.isFunction(saveCallback)){\n\t\t\t\t\tsaveCallback();\n\t\t\t\t\t\n\t\t\t\t\t//trigger send stores list event\n\t\t\t\t\tself.$root.trigger(self.options.sendStoreListEvent, [self.stores, getStoresView(self)]);\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\t\t\t$root.jplist(self.options.jplist);\n\t\t}\n\t};\n\t\n\t/**\n\t* panel constructor\n\t* @param {jQueryObject} $root - jlocator root element\n\t* @param {Object} options - jlocator user options\n\t* @return {Object} - panel + this\t\n\t* @constructor \n\t*/\n\tvar Init = function($root, options){\n\t\n\t\tvar self = {\n\t\t\t$root: $root\n\t\t\t,options: options\n\t\t\t,stores: []\n\t\t\t\n\t\t\t//elements\n\t\t\t,$panelRoot: $root.find('[data-type=\"panel\"]')\n\t\t\t,$stores: null\n\t\t};\t\n\n\t\t//init vars\n\t\tself.$stores = self.$panelRoot.find('[data-type=\"stores\"] [data-type=\"store\"]');\n\t\t\n\t\t//init store list\n\t\tself.stores = initStoresList(self);\n\t\t\n\t\t//init jplist plugin\n\t\tinitJPlist(self, self.$root);\n\t\t\t\t\n\t\treturn $.extend(this, self);\n\t};\n\t\n\t/**\n\t* panel constructor\n\t* @param {jQueryObject} $root - jlocator root element\n\t* @param {Object} options - jlocator user options\n\t* @return {Object} - panel\n\t* @constructor \n\t* @name panel\n    * @class Controller\n    * @memberOf jQuery.fn.jlocator\n\t* @property {jQueryObject} $root - jlocator root element\n\t* @property {Object} options - jlocator user options\n\t* @property {Array.<jQuery.fn.jlocator.store>} stores - jlocator stores array\n\t* @property {jQueryObject} $panelRoot - panel root element\n\t* @property {jQueryObject} $stores - stores list as jquery element\n\t*/\n\tjQuery.fn.jlocator.panel = function($root, options){\n\t\t\t\t\n\t\t//call constructor\n\t\tvar self = new Init($root, options);\t\n\n\t\t//init events\n\t\tinitEvents(self);\n\t\t\n\t\treturn self;\n\t};\n})(jQuery);\n\n"],"sourceRoot":"/source/"}