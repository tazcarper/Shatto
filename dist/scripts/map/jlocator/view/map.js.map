{"version":3,"sources":["map/jlocator/view/map.js"],"names":[],"mappings":"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","file":"map/jlocator/view/map.js","sourcesContent":["(function($){\n\t'use strict';\t\t\n\t\n\t/**\n\t* set directions\n\t* @param {Object} self - this object\n\t* @param {Object|string} start\n\t* @param {Object|string} end\n\t*/\n\tvar setDirections = function(self, start, end){\n\t\n\t\tvar request;\n\t\t\n\t\t//init request\n\t\trequest = {\n            origin:start\n            ,destination:end\n            ,travelMode: google.maps['DirectionsTravelMode'][self.options.directionsType]\n        };\n\t\t\n\t\tself.directionsService['route'](request, function(response, status){\n\t\t\t\n\t\t\tif(status == google.maps['DirectionsStatus']['OK']){\n\t\t\t\tself.directionsDisplay['setDirections'](response);\n\t\t\t}\n        });\n\t};\n\t\n\t/**\n\t* close all info windows\n\t* @param {Object} self - this object\n\t*/\n\tvar closeAllInfoWindows = function(self){\n\t\n\t\tvar cmarker;\n\t\t\n\t\t//close all opened info windows\n\t\tfor(var i=0; i<self.markers.length; i++){\n\t\t\n\t\t\t//marker\n\t\t\tcmarker = self.markers[i];\n\t\t\t\n\t\t\tif(cmarker.infowindow){\n\t\t\t\tcmarker.infowindow.close();\n\t\t\t}\n\t\t}\n\t};\n\t\n\t/**\n\t* open info window\n\t* @param {Object} self - this object\n\t* @param {Object} marker\n\t*/\n\tvar openInfoWindow = function(self, marker){\n\t\n\t\t//close all info windows\n\t\tcloseAllInfoWindows(self);\n\t\t\n\t\t//open current info window\n\t\tmarker.infowindow.open(self.mapCanvas, marker);\n\t};\n\t\n\t/**\n\t* clear markers\n\t* @param {Object} self - this object\n\t*/\n\tvar clearMarkers = function(self){\n\t\t\n\t\tvar marker;\n\t\t\n\t\tfor(var i=0; i<self.markers.length; i++){\n\t\t\n\t\t\t//get marker\n\t\t\tmarker = self.markers[i];\n\t\t\t\n\t\t\t//clear marker\n\t\t\tmarker.setMap(null);\n\t\t}\n\t\t\n\t\t//empty markers\n\t\tself.markers = [];\n\t};\n\t\n\t/**\n\t* find marker by store\n\t* @param {Object} self - this object\n\t* @param {jQuery.fn.jlocator.store} store\n\t* @return {Object|null} marker\n\t*/\n\tvar findMarker = function(self, store){\n\t\t\n\t\tvar marker\n\t\t\t,markerStore;\n\t\t\n\t\tfor(var i=0; i<self.markers.length; i++){\n\t\t\t\n\t\t\t//get marker\n\t\t\tmarker = self.markers[i];\n\t\t\t\n\t\t\t//get marker store\n\t\t\tmarkerStore = marker['store'];\n\t\t\t\n\t\t\tif(markerStore && \n\t\t\t\tmarkerStore.latitude === store.latitude &&\n\t\t\t\tmarkerStore.longitude === store.longitude){\n\t\t\t\t\n\t\t\t\treturn marker;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn null;\n\t};\n\t\n\t/**\n\t* set markers\n\t* @param {Object} self - this object\n\t* @param {jQuery.fn.jlocator.store} store\n\t*/\n\tvar setMarker = function(self, store){\n\t\t\n\t\tvar infowindow\n\t\t\t,marker\n\t\t\t,markerSettings;\n\t\t\n\t\t//init info window\n\t\tinfowindow = new google.maps.InfoWindow({\n\t\t\t\"borderRadius\": 25\n\t\t});\n\t\t\n\t\t//set info window html\n\t\tif($.isFunction(self.options.infoWindow)){\n\t\t\tinfowindow.setContent(self.options.infoWindow(store['html'], store.title, store.address, store.city, store.state, store.zipcode, store.country));\n\t\t}\n\t\t\n\t\t//init marker settings\n\t\tmarkerSettings = {\n\t\t\tposition: store.latlng\n\t\t\t,map: self.mapCanvas\n\t\t\t,title: self.options.markerText\n\t\t};\n\t\t\n\t\t//marker icon\n\t\tif(store.customMarkerIcon !== ''){\n\t\t\tmarkerSettings.icon = store.customMarkerIcon;\n\t\t}\n\t\telse{\n\t\t\tif(self.options.markerIcon !== ''){\n\t\t\t\tmarkerSettings.icon = self.options.markerIcon;\n\t\t\t}\n\t\t}\n\t\t\n\t\t//create marker\n\t\tmarker = new google.maps.Marker(markerSettings);\n\t\t\n\t\t$.extend(marker,{\n\t\t\tinfowindow: infowindow\n\t\t\t,store: store\n\t\t});\t\n\t\t\n\t\t//add marker to the markers list\n\t\tself.markers.push(marker);\n\t\t\n\t\tgoogle.maps.event.addListener(marker, 'click', function(e){\t\t\t\n\t\t\t\n\t\t\t//open popup\n\t\t\topenInfoWindow(self, this);\n\t\t\t\n\t\t\t//trigger event\n\t\t\tself.$root.trigger(self.options.pinClickEvent, [store]);\n\t\t});\n\t};\n\t\n\t/**\n\t* set markers\n\t* @param {Object} self - this object\n\t* @param {Array.<jQuery.fn.jlocator.store>} stores\n\t*/\n\tvar setMarkers = function(self, stores){\t\n\t\t\n\t\tvar store;\n\t\t\n\t\t//clear markers\n\t\tclearMarkers(self);\n\t\t\n\t\tfor(var i=0; i<stores.length; i++){\n\t\t\n\t\t\t//get store\n\t\t\tstore = stores[i];\n\t\t\t\n\t\t\t//set marker\n\t\t\tsetMarker(self, store);\n\t\t}\n\t};\n\t\n\t/**\n\t* set zoom\n\t* @param {Object} self - this object\n\t* @param {number} zoom\n\t*/\n\tvar setZoom = function(self, zoom){\t\n\t\tself.mapCanvas.setZoom(zoom);\n\t};\n\t\n\t/**\n\t* jump\n\t* @param {Object} self - this object\n\t* @param {google.maps.LatLng} latlng\n\t* @param {number} zoom\n\t*/\n\tvar jump = function(self, latlng, zoom){\t\n\t\tself.mapCanvas.setCenter(latlng);\n\t\tself.mapCanvas.setZoom(zoom);\n\t};\n\t\n\t/**\n\t* init geolocation\n\t* @param {Object} self - this object\n\t*/\t\n\tvar initGeolocation = function(self){\n\t\n\t\tvar latitude\n\t\t\t,longitude\n\t\t\t,latlng;\n\t\t\n\t\tif(self.options.geolocation && navigator.geolocation){\n\t\t\n\t\t\tnavigator.geolocation.getCurrentPosition(function(position){\n\t\t\t\t\n\t\t\t\tlatitude = position.coords.latitude;\n\t\t\t\tlongitude = position.coords.longitude;\t\n\t\t\t\tlatlng = new google.maps.LatLng(latitude, longitude);\n\t\t\t\t\n\t\t\t\t//jump to map\n\t\t\t\tjump(self, latlng, self.options.storeZoom);\t\n\t\t\t});\n\t\t}\n\t};\n\t\n\t/**\n\t* init events\n\t* @param {Object} self - 'this' object\n\t*/\n\tvar initEvents = function(self){\n\t\t\n\t\t/**\n\t\t* on jump event\n\t\t*/\n\t\tself.$root.on(self.options.jumpEvent, function(e, latitude, longitude, zoom){\n\t\t\n\t\t\tvar latlng = new google.maps.LatLng(latitude, longitude);\n\t\t\t\n\t\t\tjump(self, latlng, zoom);\n\t\t});\n\t\t\n\t\t/**\n\t\t* on init zoom event\n\t\t*/\n\t\tself.$root.on(self.options.initZoomEvent, function(e, zoom){\t\t\n\t\t\tsetZoom(self, zoom);\n\t\t});\n\t\t\n\t\t/**\n\t\t* bind store click event\n\t\t*/\n\t\tself.$root.on(self.options.storeClickEvent, function(e, store){\n\t\t\t\n\t\t\tvar marker;\n\t\t\t\n\t\t\tif(store){\n\t\t\t\n\t\t\t\t//close all info windows\n\t\t\t\tcloseAllInfoWindows(self);\n\t\t\t\t\t\t\t\t\n\t\t\t\t//jump to the store\n\t\t\t\tjump(self, store.latlng, store.zoom);\n\t\t\t\t\n\t\t\t\tif(self.options.openInfoWindowOnStoreClick){\n\t\t\t\t\t\n\t\t\t\t\t//get marker by store\n\t\t\t\t\tmarker = findMarker(self, store);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tif(marker){\n\t\t\t\t\t\tgoogle.maps.event.trigger(marker, 'click');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\t/**\n\t\t* bind stores list event\n\t\t*/\n\t\tself.$root.on(self.options.sendStoreListEvent, function(e, fullStoresList, storesView){\n\t\t\t\n\t\t\tsetMarkers(self, storesView);\n\t\t});\n\t\t\n\t\t/**\n\t\t* bind set directions event\n\t\t*/\n\t\tself.$root.on(self.options.setDirectionsEvent, function(e, start, end){\t\t\t\n\t\t\tsetDirections(self, start, end);\t\t\t\n\t\t});\n\t};\n\t\n\t/**\n\t* init map\n\t* @param {Object} self - 'this' object\n\t* @param {jQueryObject} $mapRoot - map root jquery element\n\t*/\n\tvar initMap = function(self, $mapRoot){\n\t\t\n\t\tvar pyrmont;\n\t\t\t\t\n\t\tif(google && google.maps){\n\t\t\n\t\t\tgoogle.maps.event.addDomListener(window, 'load', function(){\n\t\t\t\t\n\t\t\t\t//directions\n\t\t\t\tself.directionsService = new google.maps['DirectionsService']();\n\t\t\t\tself.directionsDisplay = new google.maps['DirectionsRenderer']();\t\n\t\t\n\t\t\t\t//init pyrmont\n\t\t\t\tpyrmont = new google.maps.LatLng(self.options.latitude, self.options.longitude);\n\t\t\t\t\n\t\t\t\t//create map\n\t\t\t\tself.mapCanvas = new google.maps.Map(self.$mapRoot.get(0), \n\t\t\t\t{\n\t\t\t\t\tmapTypeId: google.maps.MapTypeId[self.options.mapTypeId]\n\t\t\t\t\t,center: pyrmont\n\t\t\t\t\t,zoom: self.options.startZoom\n\t\t\t\t\t,streetViewControl: false\n\t\t\t\t\t,mapTypeControl: false\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t//init directions display\n\t\t\t\tself.directionsDisplay.setMap(self.mapCanvas);\n\t\t\t\t\n\t\t\t\t//init events\n\t\t\t\tinitEvents(self);\n\t\t\t\t\n\t\t\t\t//get stores list -> draw markers\n\t\t\t\tself.$root.trigger(self.options.getStoresListEvent, []);\n\t\t\t\t\n\t\t\t\t//init geolocation (if needed)\n\t\t\t\tinitGeolocation(self);\n\t\t\t});\n\t\t}\n\t};\n\t\n\t/**\n\t* map constructor\n\t* @param {jQueryObject} $root - jlocator root element\n\t* @param {Object} options - jlocator user options\n\t* @return {Object} - map + this\t\n\t* @constructor \n\t*/\n\tvar Init = function($root, options){\n\t\n\t\tvar self = {\n\t\t\t$root: $root\n\t\t\t,options: options\n\t\t\t\n\t\t\t//map\n\t\t\t,mapCanvas: null\n\t\t\t,geocoder: null\n\t\t\t,markers: []\n\t\t\t\n\t\t\t//jplist\n\t\t\t,$mapRoot: $root.find('[data-type=\"map\"]')\n\t\t\t\n\t\t\t//directions\n\t\t\t,directionsService: null\n\t\t\t,directionsDisplay: null\n\t\t};\t\t\n\t\t\n\t\t//init map\n\t\tinitMap(self, self.$mapRoot);\n\t\t\t\t\n\t\treturn $.extend(this, self);\n\t};\n\t\n\t/**\n\t* map\n\t* @param {jQueryObject} $root - jlocator root element\n\t* @param {Object} options - jlocator user options\n\t* @return {Object} - map\n\t* @constructor \n\t* @name map\n    * @class Controller\n    * @memberOf jQuery.fn.jlocator\n\t* @property {jQueryObject} $root - jlocator root element\n\t* @property {Object} options - jlocator user options\n\t* @property {Object} mapCanvas - map convas element\n\t* @property {Object} geocoder - google geocoder element\n\t* @property {jQueryObject} $mapRoot - map root element\n\t* @property {Object} directionsService - google directions service\n\t* @property {Object} directionsDisplay - google directions display\n\t*/\n\tjQuery.fn.jlocator.map = function($root, options){\n\t\t\t\t\n\t\t//call constructor\n\t\treturn new Init($root, options);\t\n\t};\n})(jQuery);\n\n"],"sourceRoot":"/source/"}