{"version":3,"sources":["map/jlocator/view/map.js"],"names":[],"mappings":"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","file":"map/jlocator/view/map.js","sourcesContent":["(function($){\n\t'use strict';\t\t\n\t\n\t/**\n\t* set directions\n\t* @param {Object} self - this object\n\t* @param {Object|string} start\n\t* @param {Object|string} end\n\t*/\n\tvar setDirections = function(self, start, end){\n\t\n\t\tvar request;\n\t\t\n\t\t//init request\n\t\trequest = {\n            origin:start\n            ,destination:end\n            ,travelMode: google.maps['DirectionsTravelMode'][self.options.directionsType]\n        };\n\t\t\n\t\tself.directionsService['route'](request, function(response, status){\n\t\t\t\n\t\t\tif(status == google.maps['DirectionsStatus']['OK']){\n\t\t\t\tself.directionsDisplay['setDirections'](response);\n\t\t\t}\n        });\n\t};\n\t\n\t/**\n\t* close all info windows\n\t* @param {Object} self - this object\n\t*/\n\tvar closeAllInfoWindows = function(self){\n\t\n\t\tvar cmarker;\n\t\t\n\t\t//close all opened info windows\n\t\tfor(var i=0; i<self.markers.length; i++){\n\t\t\n\t\t\t//marker\n\t\t\tcmarker = self.markers[i];\n\t\t\t\n\t\t\tif(cmarker.infowindow){\n\t\t\t\tcmarker.infowindow.close();\n\t\t\t}\n\t\t}\n\t};\n\t\n\t/**\n\t* open info window\n\t* @param {Object} self - this object\n\t* @param {Object} marker\n\t*/\n\tvar openInfoWindow = function(self, marker){\n\t\n\t\t//close all info windows\n\t\tcloseAllInfoWindows(self);\n\t\t\n\t\t//open current info window\n\t\tmarker.infowindow.open(self.mapCanvas, marker);\n\t};\n\t\n\t/**\n\t* clear markers\n\t* @param {Object} self - this object\n\t*/\n\tvar clearMarkers = function(self){\n\t\t\n\t\tvar marker;\n\t\t\n\t\tfor(var i=0; i<self.markers.length; i++){\n\t\t\n\t\t\t//get marker\n\t\t\tmarker = self.markers[i];\n\t\t\t\n\t\t\t//clear marker\n\t\t\tmarker.setMap(null);\n\t\t}\n\t\t\n\t\t//empty markers\n\t\tself.markers = [];\n\t};\n\t\n\t/**\n\t* find marker by store\n\t* @param {Object} self - this object\n\t* @param {jQuery.fn.jlocator.store} store\n\t* @return {Object|null} marker\n\t*/\n\tvar findMarker = function(self, store){\n\t\t\n\t\tvar marker\n\t\t\t,markerStore;\n\t\t\n\t\tfor(var i=0; i<self.markers.length; i++){\n\t\t\t\n\t\t\t//get marker\n\t\t\tmarker = self.markers[i];\n\t\t\t\n\t\t\t//get marker store\n\t\t\tmarkerStore = marker['store'];\n\t\t\t\n\t\t\tif(markerStore && \n\t\t\t\tmarkerStore.latitude === store.latitude &&\n\t\t\t\tmarkerStore.longitude === store.longitude){\n\t\t\t\t\n\t\t\t\treturn marker;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn null;\n\t};\n\t\n\t/**\n\t* set markers\n\t* @param {Object} self - this object\n\t* @param {jQuery.fn.jlocator.store} store\n\t*/\n\tvar setMarker = function(self, store){\n\t\t\n\t\tvar infowindow\n\t\t\t,marker\n\t\t\t,markerSettings;\n\t\t\n\t\t//init info window\n\t\tinfowindow = new google.maps.InfoWindow();\n\t\t\n\t\t//set info window html\n\t\tif($.isFunction(self.options.infoWindow)){\n\t\t\tinfowindow.setContent(self.options.infoWindow(store['html'], store.title, store.address, store.city, store.state, store.zipcode, store.country));\n\t\t}\n\t\t\n\t\t//init marker settings\n\t\tmarkerSettings = {\n\t\t\tposition: store.latlng\n\t\t\t,map: self.mapCanvas\n\t\t\t,title: self.options.markerText\n\t\t};\n\t\t\n\t\t//marker icon\n\t\tif(store.customMarkerIcon !== ''){\n\t\t\tmarkerSettings.icon = store.customMarkerIcon;\n\t\t}\n\t\telse{\n\t\t\tif(self.options.markerIcon !== ''){\n\t\t\t\tmarkerSettings.icon = self.options.markerIcon;\n\t\t\t}\n\t\t}\n\t\t\n\t\t//create marker\n\t\tmarker = new google.maps.Marker(markerSettings);\n\t\t\n\t\t$.extend(marker,{\n\t\t\tinfowindow: infowindow\n\t\t\t,store: store\n\t\t});\t\n\t\t\n\t\t//add marker to the markers list\n\t\tself.markers.push(marker);\n\t\t\n\t\tgoogle.maps.event.addListener(marker, 'click', function(e){\t\t\t\n\t\t\t\n\t\t\t//open popup\n\t\t\topenInfoWindow(self, this);\n\t\t\t\n\t\t\t//trigger event\n\t\t\tself.$root.trigger(self.options.pinClickEvent, [store]);\n\t\t});\n\t};\n\t\n\t/**\n\t* set markers\n\t* @param {Object} self - this object\n\t* @param {Array.<jQuery.fn.jlocator.store>} stores\n\t*/\n\tvar setMarkers = function(self, stores){\t\n\t\t\n\t\tvar store;\n\t\t\n\t\t//clear markers\n\t\tclearMarkers(self);\n\t\t\n\t\tfor(var i=0; i<stores.length; i++){\n\t\t\n\t\t\t//get store\n\t\t\tstore = stores[i];\n\t\t\t\n\t\t\t//set marker\n\t\t\tsetMarker(self, store);\n\t\t}\n\t};\n\t\n\t/**\n\t* set zoom\n\t* @param {Object} self - this object\n\t* @param {number} zoom\n\t*/\n\tvar setZoom = function(self, zoom){\t\n\t\tself.mapCanvas.setZoom(zoom);\n\t};\n\t\n\t/**\n\t* jump\n\t* @param {Object} self - this object\n\t* @param {google.maps.LatLng} latlng\n\t* @param {number} zoom\n\t*/\n\tvar jump = function(self, latlng, zoom){\t\n\t\tself.mapCanvas.setCenter(latlng);\n\t\tself.mapCanvas.setZoom(zoom);\n\t};\n\t\n\t/**\n\t* init geolocation\n\t* @param {Object} self - this object\n\t*/\t\n\tvar initGeolocation = function(self){\n\t\n\t\tvar latitude\n\t\t\t,longitude\n\t\t\t,latlng;\n\t\t\n\t\tif(self.options.geolocation && navigator.geolocation){\n\t\t\n\t\t\tnavigator.geolocation.getCurrentPosition(function(position){\n\t\t\t\t\n\t\t\t\tlatitude = position.coords.latitude;\n\t\t\t\tlongitude = position.coords.longitude;\t\n\t\t\t\tlatlng = new google.maps.LatLng(latitude, longitude);\n\t\t\t\t\n\t\t\t\t//jump to map\n\t\t\t\tjump(self, latlng, self.options.storeZoom);\t\n\t\t\t});\n\t\t}\n\t};\n\t\n\t/**\n\t* init events\n\t* @param {Object} self - 'this' object\n\t*/\n\tvar initEvents = function(self){\n\t\t\n\t\t/**\n\t\t* on jump event\n\t\t*/\n\t\tself.$root.on(self.options.jumpEvent, function(e, latitude, longitude, zoom){\n\t\t\n\t\t\tvar latlng = new google.maps.LatLng(latitude, longitude);\n\t\t\t\n\t\t\tjump(self, latlng, zoom);\n\t\t});\n\t\t\n\t\t/**\n\t\t* on init zoom event\n\t\t*/\n\t\tself.$root.on(self.options.initZoomEvent, function(e, zoom){\t\t\n\t\t\tsetZoom(self, zoom);\n\t\t});\n\t\t\n\t\t/**\n\t\t* bind store click event\n\t\t*/\n\t\tself.$root.on(self.options.storeClickEvent, function(e, store){\n\t\t\t\n\t\t\tvar marker;\n\t\t\t\n\t\t\tif(store){\n\t\t\t\n\t\t\t\t//close all info windows\n\t\t\t\tcloseAllInfoWindows(self);\n\t\t\t\t\t\t\t\t\n\t\t\t\t//jump to the store\n\t\t\t\tjump(self, store.latlng, store.zoom);\n\t\t\t\t\n\t\t\t\tif(self.options.openInfoWindowOnStoreClick){\n\t\t\t\t\t\n\t\t\t\t\t//get marker by store\n\t\t\t\t\tmarker = findMarker(self, store);\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tif(marker){\n\t\t\t\t\t\tgoogle.maps.event.trigger(marker, 'click');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\t/**\n\t\t* bind stores list event\n\t\t*/\n\t\tself.$root.on(self.options.sendStoreListEvent, function(e, fullStoresList, storesView){\n\t\t\t\n\t\t\tsetMarkers(self, storesView);\n\t\t});\n\t\t\n\t\t/**\n\t\t* bind set directions event\n\t\t*/\n\t\tself.$root.on(self.options.setDirectionsEvent, function(e, start, end){\t\t\t\n\t\t\tsetDirections(self, start, end);\t\t\t\n\t\t});\n\t};\n\t\n\t/**\n\t* init map\n\t* @param {Object} self - 'this' object\n\t* @param {jQueryObject} $mapRoot - map root jquery element\n\t*/\n\tvar initMap = function(self, $mapRoot){\n\t\t\n\t\tvar pyrmont;\n\t\t\t\t\n\t\tif(google && google.maps){\n\t\t\n\t\t\tgoogle.maps.event.addDomListener(window, 'load', function(){\n\t\t\t\t\n\t\t\t\t//directions\n\t\t\t\tself.directionsService = new google.maps['DirectionsService']();\n\t\t\t\tself.directionsDisplay = new google.maps['DirectionsRenderer']();\t\n\t\t\n\t\t\t\t//init pyrmont\n\t\t\t\tpyrmont = new google.maps.LatLng(self.options.latitude, self.options.longitude);\n\t\t\t\t\n\t\t\t\t//create map\n\t\t\t\tself.mapCanvas = new google.maps.Map(self.$mapRoot.get(0), \n\t\t\t\t{\n\t\t\t\t\tmapTypeId: google.maps.MapTypeId[self.options.mapTypeId]\n\t\t\t\t\t,center: pyrmont\n\t\t\t\t\t,zoom: self.options.startZoom\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t//init directions display\n\t\t\t\tself.directionsDisplay.setMap(self.mapCanvas);\n\t\t\t\t\n\t\t\t\t//init events\n\t\t\t\tinitEvents(self);\n\t\t\t\t\n\t\t\t\t//get stores list -> draw markers\n\t\t\t\tself.$root.trigger(self.options.getStoresListEvent, []);\n\t\t\t\t\n\t\t\t\t//init geolocation (if needed)\n\t\t\t\tinitGeolocation(self);\n\t\t\t});\n\t\t}\n\t};\n\t\n\t/**\n\t* map constructor\n\t* @param {jQueryObject} $root - jlocator root element\n\t* @param {Object} options - jlocator user options\n\t* @return {Object} - map + this\t\n\t* @constructor \n\t*/\n\tvar Init = function($root, options){\n\t\n\t\tvar self = {\n\t\t\t$root: $root\n\t\t\t,options: options\n\t\t\t\n\t\t\t//map\n\t\t\t,mapCanvas: null\n\t\t\t,geocoder: null\n\t\t\t,markers: []\n\t\t\t\n\t\t\t//jplist\n\t\t\t,$mapRoot: $root.find('[data-type=\"map\"]')\n\t\t\t\n\t\t\t//directions\n\t\t\t,directionsService: null\n\t\t\t,directionsDisplay: null\n\t\t};\t\t\n\t\t\n\t\t//init map\n\t\tinitMap(self, self.$mapRoot);\n\t\t\t\t\n\t\treturn $.extend(this, self);\n\t};\n\t\n\t/**\n\t* map\n\t* @param {jQueryObject} $root - jlocator root element\n\t* @param {Object} options - jlocator user options\n\t* @return {Object} - map\n\t* @constructor \n\t* @name map\n    * @class Controller\n    * @memberOf jQuery.fn.jlocator\n\t* @property {jQueryObject} $root - jlocator root element\n\t* @property {Object} options - jlocator user options\n\t* @property {Object} mapCanvas - map convas element\n\t* @property {Object} geocoder - google geocoder element\n\t* @property {jQueryObject} $mapRoot - map root element\n\t* @property {Object} directionsService - google directions service\n\t* @property {Object} directionsDisplay - google directions display\n\t*/\n\tjQuery.fn.jlocator.map = function($root, options){\n\t\t\t\t\n\t\t//call constructor\n\t\treturn new Init($root, options);\t\n\t};\n})(jQuery);\n\n"],"sourceRoot":"/source/"}