{"version":3,"sources":["map/jplist/controls/counter.js"],"names":[],"mappings":";;;AACA,CAAC,UAAS,CAAT,EAAW;AACX;;;;;;;;AADW;AASX,QAAO,EAAP,CAAU,MAAV,CAAiB,QAAjB,CAA0B,OAA1B,GAAoC,EAApC;;;;;;;AATW,KAgBJ,cAAc,SAAd,WAAc,CAAS,OAAT,EAAkB,QAAlB,EAA2B;;AAEzC,MAAI,WAAJ;MACK,IADL;MAEJ,QAFI;MAGJ,QAHI;MAIK,OAAO,IAAP;MACT,SAAS,EAAT;;;AAP6C,MAUzC,GAAO,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,MAAtB,CAAP,CAVyC;AAW/C,aAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,CAAX,CAX+C;AAY/C,aAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,CAAX,CAZ+C;AAa/C,gBAAc,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,aAAtB,CAAd,CAb+C;;AAe/C,UAAO,QAAP;;AAEC,QAAK,MAAL;AAAY;;;AAGX,YAAO,OAAO,EAAP,CAAU,MAAV,CAAiB,OAAjB,CAAyB,OAAzB,CAAiC,UAAjC,CACN,IADM,EAEL,QAFK,CAAP,CAHW;KAAZ;AAQA,UARA;;AAFD,QAYM,MAAL;AAAY;;AAEX,SAAG,QAAQ,kBAAR,IAA8B,QAAQ,kBAAR,CAA2B,MAA3B,EAAkC;;;AAGlE,eAAS,QAAQ,kBAAR,CAA2B,MAA3B,CAHyD;MAAnE;;;AAFW,SASX,GAAO,OAAO,EAAP,CAAU,MAAV,CAAiB,OAAjB,CAAyB,OAAzB,CAAiC,UAAjC,CACN,QADM,EAEL,IAFK,EAGL,QAHK,EAIL,MAJK,CAAP,CATW;KAAZ;AAgBA,UAhBA;;AAZD,QA8BM,OAAL;AAAa;;;AAGZ,YAAO,OAAO,EAAP,CAAU,MAAV,CAAiB,OAAjB,CAAyB,OAAzB,CAAiC,WAAjC,CACN,IADM,EAEL,QAFK,EAGL,CAHK,EAIL,CAJK,EAKL,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,SAAtB,CALK,EAML,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,SAAtB,CANK,CAAP,CAHY;KAAb;AAYA,UAZA;AA9BD,GAf+C;;AA4D/C,MAAG,IAAH,EAAQ;;AAEP,eAAY,IAAZ,CAAiB,KAAK,MAAL,CAAjB;;;AAFO,OAKJ,KAAK,MAAL,KAAgB,CAAhB,EAAkB;AACpB,YAAQ,QAAR,CAAiB,QAAjB,CAA0B,SAA1B,EADoB;IAArB,MAGI;AACH,YAAQ,QAAR,CAAiB,WAAjB,CAA6B,SAA7B,EADG;IAHJ;GALD;EA5DoB;;;;;;;AAhBV,OA+FX,CAAO,EAAP,CAAU,MAAV,CAAiB,QAAjB,CAA0B,OAA1B,CAAkC,MAAlC,GAA2C,UAAS,OAAT,EAAiB;;AAErD,MAAI,UAAJ,EACK,QADL,EAEJ,QAFI,EAGJ,QAHI,EAIJ,QAJI,EAKJ,OALI,EAMJ,OANI,EAOK,IAPL,EAQK,IARL,EASK,WATL;;;AAFqD,YAcrD,GAAa,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,aAAtB,CAAb,CAdqD;AAe3D,aAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,WAAtB,CAAX,CAf2D;;AAiB3D,aAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,WAAtB,CAAX,CAjB2D;AAkBrD,aAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,WAAtB,CAAX,CAlBqD;AAmB3D,aAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,WAAtB,CAAX,CAnB2D;AAoB3D,YAAU,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,CAAV,CApB2D;AAqB3D,YAAU,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,CAAV,CArB2D;;AAuBrD,MAAG,CAAC,QAAD,EAAU;AACV,cAAW,QAAX,CADU;GAAb;;AAIN,MAAG,CAAC,QAAD,EAAU;AACJ,cAAW,MAAX,CADI;GAAb;;;AA3B2D,MAgClD,UAAH,EAAc;;;AAGV,UAAO,WAAW,OAAX,CAAmB,SAAnB,EAA8B,uCAA9B,CAAP;;;AAHU,UAMV,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,IAAtB;;;AANU,cASV,GAAc,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,2BAAtB,CAAd;;;AATU,UAYV,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,aAAtB,EAAqC,WAArC,EAZU;GAAd;;AAeA,MAAG,QAAH,EAAY;;;AAGR,UAAO,IAAI,OAAO,EAAP,CAAU,MAAV,CAAiB,MAAjB,CAAwB,IAAxB,CAA6B,QAAjC,EAA2C,IAA3C,CAAP,CAHQ;AAIjB,WAAQ,QAAR,CAAiB,IAAjB,CAAsB,MAAtB,EAA8B,IAA9B,EAJiB;GAAZ;;;AA/CqD,SAuD3D,CAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,EAAkC,QAAlC,EAvD2D;AAwD3D,UAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,EAAkC,QAAlC,EAxD2D;;AA0D3D,UAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,EAAkC,QAAlC,EA1D2D;AA2D3D,UAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,EAAkC,QAAlC,EA3D2D;;AA6D3D,UAAQ,QAAR,CAAiB,IAAjB,CAAsB,SAAtB,EAAiC,OAAjC,EA7D2D;AA8D3D,UAAQ,QAAR,CAAiB,IAAjB,CAAsB,SAAtB,EAAiC,OAAjC,EA9D2D;EAAjB;;;;;;;AA/FhC,OAqKX,CAAO,EAAP,CAAU,MAAV,CAAiB,QAAjB,CAA0B,OAA1B,CAAkC,UAAlC,GAA+C,UAAS,OAAT,EAAiB;;AAEzD,MAAI,WAAW,QAAQ,QAAR,CAAiB,IAAjB,CAAsB,UAAtB,CAAX,CAFqD;;AAI/D,UAAO,QAAP;;;;;AAKC,QAAK,QAAL;AAAc;;;;;;;AAOb,aAAQ,UAAR,CAAmB,EAAnB,CAAsB,QAAQ,OAAR,CAAgB,sBAAhB,EAAwC,UAAS,CAAT,EAAY,UAAZ,EAAuB;;AAEpF,kBAAY,OAAZ,EAAqB,WAAW,SAAX,CAArB,CAFoF;MAAvB,CAA9D,CAPa;KAAd;AAYA,UAZA;;;;;AALD,QAsBM,QAAL;AAAc;;;;;;;;AAQb,aAAQ,UAAR,CAAmB,EAAnB,CAAsB,QAAQ,OAAR,CAAgB,YAAhB,EAA8B,UAAS,CAAT,EAAY,QAAZ,EAAsB,UAAtB,EAAiC;;AAEpF,kBAAY,OAAZ,EAAqB,WAAW,QAAX,CAArB,CAFoF;MAAjC,CAApD,CARa;KAAd;AAaA,UAbA;;;;;AAtBD,QAwCM,KAAL;AAAW;;;;;;;;AAQV,aAAQ,UAAR,CAAmB,EAAnB,CAAsB,QAAQ,OAAR,CAAgB,YAAhB,EAA8B,UAAS,CAAT,EAAY,QAAZ,EAAsB,UAAtB,EAAiC;AACpF,kBAAY,OAAZ,EAAqB,WAAW,QAAX,CAArB,CADoF;MAAjC,CAApD,CARU;KAAX;AAYA,UAZA;AAxCD,GAJ+D;EAAjB,CArKpC;CAAX,CAAD,CAmOG,MAnOH","file":"map/jplist/controls/counter.js","sourcesContent":["/*global jQuery:false */\n(function($){\n\t'use strict';\t\t\n\t\n\t/** \n\t* Counter control\n\t* @type {Object}\n\t* @class Counter control - used to print a number of items with the given jQuery path\n    * @memberOf jQuery.fn.jplist\n\t*/\n\tjQuery.fn.jplist.controls.Counter = {};\n\n    /**\n     * redraw counter value\n     * @param {jQuery.fn.jplist.view.PanelControl} control\n     * @param {Array.<jQuery.fn.jplist.models.Dataitem>} dataview\n     */\n    var drawCounter = function(control, dataview){\n\n        var $countValue\n            ,path\n\t\t\t,dataText\n\t\t\t,dataType\n            ,list = null\n\t\t\t,ignore = '';\n\n        //get path object from data\n        path = control.$control.data('path'); \n\t\tdataType = control.$control.data('dataType');\n\t\tdataText = control.$control.data('dataText');\t\n\t\t$countValue = control.$control.data('$countValue');\n\t\t\n\t\tswitch(dataType){\n\t\t\t\n\t\t\tcase 'path':{\n\t\t\t\t\n\t\t\t\t//get dataview\n\t\t\t\tlist = jQuery.fn.jplist.actions.Filters.pathFilter(\n\t\t\t\t\tpath\n\t\t\t\t\t,dataview\n\t\t\t\t);  \n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\tcase 'text':{\n\t\t\t\t\n\t\t\t\tif(control.controlTypeOptions && control.controlTypeOptions.ignore){\n\t\t\t\t \n\t\t\t\t\t//get ignore characters\n\t\t\t\t\tignore = control.controlTypeOptions.ignore;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//get dataview\n\t\t\t\tlist = jQuery.fn.jplist.actions.Filters.textFilter(\n\t\t\t\t\tdataText\n\t\t\t\t\t,path\n\t\t\t\t\t,dataview\n\t\t\t\t\t,ignore\n\t\t\t\t);\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\tcase 'range':{\n\t\t\n\t\t\t\t//get dataview\n\t\t\t\tlist = jQuery.fn.jplist.actions.Filters.rangeFilter(\n\t\t\t\t\tpath\n\t\t\t\t\t,dataview\n\t\t\t\t\t,0\n\t\t\t\t\t,0\n\t\t\t\t\t,control.$control.data('dataMin')\n\t\t\t\t\t,control.$control.data('dataMax')\n\t\t\t\t);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\t\n\t\tif(list){\n\t\t\t//update value\n\t\t\t$countValue.html(list.length);\n\n\t\t\t//update class\n\t\t\tif(list.length === 0){\n\t\t\t\tcontrol.$control.addClass('count-0');\n\t\t\t}\n\t\t\telse{\n\t\t\t\tcontrol.$control.removeClass('count-0');\n\t\t\t}\n\t\t}\n    };\n\n    /**\n\t* Render control html\n\t* @param {jQuery.fn.jplist.view.PanelControl} control\n\t* @memberOf jQuery.fn.jplist.controls.Counter\n\t*/\n\tjQuery.fn.jplist.controls.Counter.render = function(control){\n\n        var dataFormat\n            ,dataPath\n\t\t\t,dataText\n\t\t\t,dataMode\n\t\t\t,dataType\n\t\t\t,dataMin\n\t\t\t,dataMax\n            ,path\n            ,html\n            ,$countValue;\n\n        //get format\n        dataFormat = control.$control.attr('data-format');\t\t\n\t\tdataMode = control.$control.attr('data-mode');\n\t\t\n\t\tdataType = control.$control.attr('data-type');\n        dataPath = control.$control.attr('data-path');\n\t\tdataText = control.$control.attr('data-text');\n\t\tdataMin = control.$control.attr('data-min');\n\t\tdataMax = control.$control.attr('data-max');\n\n        if(!dataMode){\n           dataMode = 'static';\n        }\n\t\t\n\t\tif(!dataType){\n           dataType = 'path';\n        }\n\n        //init text format\n        if(dataFormat){\n\n            //get parsed html\n            html = dataFormat.replace('{count}', '<span data-type=\"count-value\"></span>');\n\n            //print html\n            control.$control.html(html);\n\n            //get element\n            $countValue = control.$control.find('[data-type=\"count-value\"]');\n\n            //save it in data\n            control.$control.data('$countValue', $countValue);\n        }\n\n        if(dataPath){\n\n            //get path\n            path = new jQuery.fn.jplist.models.Path(dataPath, null);     \n\t\t\tcontrol.$control.data('path', path);\t\t\t\n        }\n\t\t\n\t\t//save data\t\t\t\n\t\tcontrol.$control.data('dataMode', dataMode);\n\t\tcontrol.$control.data('dataType', dataType);\n\t\t\n\t\tcontrol.$control.data('dataPath', dataPath);\n\t\tcontrol.$control.data('dataText', dataText);\n\t\t\n\t\tcontrol.$control.data('dataMin', dataMin);\n\t\tcontrol.$control.data('dataMax', dataMax);\n\t};\n\n    /**\n\t* Init control events\n\t* @param {jQuery.fn.jplist.view.PanelControl} control\n\t* @memberOf jQuery.fn.jplist.controls.Counter\n\t*/\n\tjQuery.fn.jplist.controls.Counter.initEvents = function(control){\n\n        var dataMode = control.$control.data('dataMode');\n\t\t\n\t\tswitch(dataMode){\n\t\t\t\n\t\t\t/**\n\t\t\t* init count on page load once - if data-mode=\"static\"\n\t\t\t*/\n\t\t\tcase 'static':{\t\n\t\t\t\n\t\t\t\t/**\n\t\t\t\t * on add collection item event\n\t\t\t\t * @param {Object} e - event object\n\t\t\t\t * @param {jQuery.fn.jplist.services.Collection} collection\n\t\t\t\t */\n\t\t\t\tcontrol.$jplistBox.on(control.options.collection_ready_event, function(e, collection){\n\t\t\t\t\t\n\t\t\t\t\tdrawCounter(control, collection.dataitems);\n\t\t\t\t});\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\t/**\n\t\t\t* refresh count on every filter action - if data-mode=\"filter\"\n\t\t\t*/\n\t\t\tcase 'filter':{\t\t\t\n\t\t\t\t\n\t\t\t\t/**\n\t\t\t\t * on filter event\n\t\t\t\t * @param {Object} e - event object\n\t\t\t\t * @param {Array.<jQuery.fn.jplist.models.Status>} statuses\n\t\t\t\t * @param {jQuery.fn.jplist.services.Collection} collection\n\t\t\t\t */\n\t\t\t\tcontrol.$jplistBox.on(control.options.filter_event, function(e, statuses, collection){\n\t\t\t\t\t\n\t\t\t\t\tdrawCounter(control, collection.dataview);\n\t\t\t\t});\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\t/**\n\t\t\t* refresh count on every jplist action - if data-mode=\"all\"\n\t\t\t*/\n\t\t\tcase 'all':{\n\t\t\t\n\t\t\t\t/**\n\t\t\t\t * bind answer event\n\t\t\t\t * @param {Object} e - event object\n\t\t\t\t * @param {Array.<jQuery.fn.jplist.models.Status>} statuses\n\t\t\t\t * @param {jQuery.fn.jplist.services.Collection} collection\n\t\t\t\t */\n\t\t\t\tcontrol.$jplistBox.on(control.options.answer_event, function(e, statuses, collection){\n\t\t\t\t\tdrawCounter(control, collection.dataview);\n\t\t\t\t});\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t};\n\n\t\n\t\n})(jQuery);\n\n"],"sourceRoot":"/source/"}