{"version":3,"sources":["map/jplist/controls/counter.js"],"names":[],"mappings":"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","file":"map/jplist/controls/counter.js","sourcesContent":["/*global jQuery:false */\n(function($){\n\t'use strict';\t\t\n\t\n\t/** \n\t* Counter control\n\t* @type {Object}\n\t* @class Counter control - used to print a number of items with the given jQuery path\n    * @memberOf jQuery.fn.jplist\n\t*/\n\tjQuery.fn.jplist.controls.Counter = {};\n\n    /**\n     * redraw counter value\n     * @param {jQuery.fn.jplist.view.PanelControl} control\n     * @param {Array.<jQuery.fn.jplist.models.Dataitem>} dataview\n     */\n    var drawCounter = function(control, dataview){\n\n        var $countValue\n            ,path\n\t\t\t,dataText\n\t\t\t,dataType\n            ,list = null\n\t\t\t,ignore = '';\n\n        //get path object from data\n        path = control.$control.data('path'); \n\t\tdataType = control.$control.data('dataType');\n\t\tdataText = control.$control.data('dataText');\t\n\t\t$countValue = control.$control.data('$countValue');\n\t\t\n\t\tswitch(dataType){\n\t\t\t\n\t\t\tcase 'path':{\n\t\t\t\t\n\t\t\t\t//get dataview\n\t\t\t\tlist = jQuery.fn.jplist.actions.Filters.pathFilter(\n\t\t\t\t\tpath\n\t\t\t\t\t,dataview\n\t\t\t\t);  \n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\tcase 'text':{\n\t\t\t\t\n\t\t\t\tif(control.controlTypeOptions && control.controlTypeOptions.ignore){\n\t\t\t\t \n\t\t\t\t\t//get ignore characters\n\t\t\t\t\tignore = control.controlTypeOptions.ignore;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//get dataview\n\t\t\t\tlist = jQuery.fn.jplist.actions.Filters.textFilter(\n\t\t\t\t\tdataText\n\t\t\t\t\t,path\n\t\t\t\t\t,dataview\n\t\t\t\t\t,ignore\n\t\t\t\t);\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\tcase 'range':{\n\t\t\n\t\t\t\t//get dataview\n\t\t\t\tlist = jQuery.fn.jplist.actions.Filters.rangeFilter(\n\t\t\t\t\tpath\n\t\t\t\t\t,dataview\n\t\t\t\t\t,0\n\t\t\t\t\t,0\n\t\t\t\t\t,control.$control.data('dataMin')\n\t\t\t\t\t,control.$control.data('dataMax')\n\t\t\t\t);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\t\n\t\tif(list){\n\t\t\t//update value\n\t\t\t$countValue.html(list.length);\n\n\t\t\t//update class\n\t\t\tif(list.length === 0){\n\t\t\t\tcontrol.$control.addClass('count-0');\n\t\t\t}\n\t\t\telse{\n\t\t\t\tcontrol.$control.removeClass('count-0');\n\t\t\t}\n\t\t}\n    };\n\n    /**\n\t* Render control html\n\t* @param {jQuery.fn.jplist.view.PanelControl} control\n\t* @memberOf jQuery.fn.jplist.controls.Counter\n\t*/\n\tjQuery.fn.jplist.controls.Counter.render = function(control){\n\n        var dataFormat\n            ,dataPath\n\t\t\t,dataText\n\t\t\t,dataMode\n\t\t\t,dataType\n\t\t\t,dataMin\n\t\t\t,dataMax\n            ,path\n            ,html\n            ,$countValue;\n\n        //get format\n        dataFormat = control.$control.attr('data-format');\t\t\n\t\tdataMode = control.$control.attr('data-mode');\n\t\t\n\t\tdataType = control.$control.attr('data-type');\n        dataPath = control.$control.attr('data-path');\n\t\tdataText = control.$control.attr('data-text');\n\t\tdataMin = control.$control.attr('data-min');\n\t\tdataMax = control.$control.attr('data-max');\n\n        if(!dataMode){\n           dataMode = 'static';\n        }\n\t\t\n\t\tif(!dataType){\n           dataType = 'path';\n        }\n\n        //init text format\n        if(dataFormat){\n\n            //get parsed html\n            html = dataFormat.replace('{count}', '<span data-type=\"count-value\"></span>');\n\n            //print html\n            control.$control.html(html);\n\n            //get element\n            $countValue = control.$control.find('[data-type=\"count-value\"]');\n\n            //save it in data\n            control.$control.data('$countValue', $countValue);\n        }\n\n        if(dataPath){\n\n            //get path\n            path = new jQuery.fn.jplist.models.Path(dataPath, null);     \n\t\t\tcontrol.$control.data('path', path);\t\t\t\n        }\n\t\t\n\t\t//save data\t\t\t\n\t\tcontrol.$control.data('dataMode', dataMode);\n\t\tcontrol.$control.data('dataType', dataType);\n\t\t\n\t\tcontrol.$control.data('dataPath', dataPath);\n\t\tcontrol.$control.data('dataText', dataText);\n\t\t\n\t\tcontrol.$control.data('dataMin', dataMin);\n\t\tcontrol.$control.data('dataMax', dataMax);\n\t};\n\n    /**\n\t* Init control events\n\t* @param {jQuery.fn.jplist.view.PanelControl} control\n\t* @memberOf jQuery.fn.jplist.controls.Counter\n\t*/\n\tjQuery.fn.jplist.controls.Counter.initEvents = function(control){\n\n        var dataMode = control.$control.data('dataMode');\n\t\t\n\t\tswitch(dataMode){\n\t\t\t\n\t\t\t/**\n\t\t\t* init count on page load once - if data-mode=\"static\"\n\t\t\t*/\n\t\t\tcase 'static':{\t\n\t\t\t\n\t\t\t\t/**\n\t\t\t\t * on add collection item event\n\t\t\t\t * @param {Object} e - event object\n\t\t\t\t * @param {jQuery.fn.jplist.services.Collection} collection\n\t\t\t\t */\n\t\t\t\tcontrol.$jplistBox.on(control.options.collection_ready_event, function(e, collection){\n\t\t\t\t\t\n\t\t\t\t\tdrawCounter(control, collection.dataitems);\n\t\t\t\t});\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\t/**\n\t\t\t* refresh count on every filter action - if data-mode=\"filter\"\n\t\t\t*/\n\t\t\tcase 'filter':{\t\t\t\n\t\t\t\t\n\t\t\t\t/**\n\t\t\t\t * on filter event\n\t\t\t\t * @param {Object} e - event object\n\t\t\t\t * @param {Array.<jQuery.fn.jplist.models.Status>} statuses\n\t\t\t\t * @param {jQuery.fn.jplist.services.Collection} collection\n\t\t\t\t */\n\t\t\t\tcontrol.$jplistBox.on(control.options.filter_event, function(e, statuses, collection){\n\t\t\t\t\t\n\t\t\t\t\tdrawCounter(control, collection.dataview);\n\t\t\t\t});\n\t\t\t}\n\t\t\tbreak;\n\t\t\t\n\t\t\t/**\n\t\t\t* refresh count on every jplist action - if data-mode=\"all\"\n\t\t\t*/\n\t\t\tcase 'all':{\n\t\t\t\n\t\t\t\t/**\n\t\t\t\t * bind answer event\n\t\t\t\t * @param {Object} e - event object\n\t\t\t\t * @param {Array.<jQuery.fn.jplist.models.Status>} statuses\n\t\t\t\t * @param {jQuery.fn.jplist.services.Collection} collection\n\t\t\t\t */\n\t\t\t\tcontrol.$jplistBox.on(control.options.answer_event, function(e, statuses, collection){\n\t\t\t\t\tdrawCounter(control, collection.dataview);\n\t\t\t\t});\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t};\n\n\t\n\t\n})(jQuery);\n\n"],"sourceRoot":"/source/"}